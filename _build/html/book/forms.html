

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Forms &mdash; Symfony2Docs v2.1.0 2.1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Symfony2Docs v2.1.0 2.1.0 documentation" href="../index.html" />
    <link rel="up" title="The Book" href="index.html" />
    <link rel="next" title="Security" href="security.html" />
    <link rel="prev" title="Validation" href="validation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="security.html" title="Security"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="validation.html" title="Validation"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Symfony2Docs v2.1.0 2.1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">The Book</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="forms">
<span id="index-0"></span><h1>Forms<a class="headerlink" href="#forms" title="Permalink to this headline">¶</a></h1>
<p>Dealing with HTML forms is one of the most common - and challenging - tasks for
a web developer. Symfony2 integrates a Form component that makes dealing with
forms easy. In this chapter, you&#8217;ll build a complex form from the ground-up,
learning the most important features of the form library along the way.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Symfony form component is a standalone library that can be used outside
of Symfony2 projects. For more information, see the <a class="reference external" href="https://github.com/symfony/Form">Symfony2 Form Component</a>
on Github.</p>
</div>
<div class="section" id="creating-a-simple-form">
<span id="index-1"></span><h2>Creating a Simple Form<a class="headerlink" href="#creating-a-simple-form" title="Permalink to this headline">¶</a></h2>
<p>Suppose you&#8217;re building a simple todo list application that will need to
display &#8220;tasks&#8221;. Because your users will need to edit and create tasks, you&#8217;re
going to need to build a form. But before you begin, first focus on the generic
<tt class="docutils literal"><span class="pre">Task</span></tt> class that represents and stores the data for a single task:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/TaskBundle/Entity/Task.php</span>
<span class="k">namespace</span> <span class="nx">Acme\TaskBundle\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Task</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$task</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$dueDate</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getTask</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">task</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTask</span><span class="p">(</span><span class="nv">$task</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">task</span> <span class="o">=</span> <span class="nv">$task</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDueDate</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dueDate</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setDueDate</span><span class="p">(</span><span class="nx">\DateTime</span> <span class="nv">$dueDate</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dueDate</span> <span class="o">=</span> <span class="nv">$dueDate</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you&#8217;re coding along with this example, create the <tt class="docutils literal"><span class="pre">AcmeTaskBundle</span></tt>
first by running the following command (and accepting all of the default
options):</p>
<div class="last highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>php app/console generate:bundle --namespace<span class="o">=</span>Acme/TaskBundle
</pre></div>
</div>
</div>
<p>This class is a &#8220;plain-old-PHP-object&#8221; because, so far, it has nothing
to do with Symfony or any other library. It&#8217;s quite simply a normal PHP object
that directly solves a problem inside <em>your</em> application (i.e. the need to
represent a task in your application). Of course, by the end of this chapter,
you&#8217;ll be able to submit data to a <tt class="docutils literal"><span class="pre">Task</span></tt> instance (via an HTML form), validate
its data, and persist it to the database.</p>
<div class="section" id="building-the-form">
<span id="index-2"></span><h3>Building the Form<a class="headerlink" href="#building-the-form" title="Permalink to this headline">¶</a></h3>
<p>Now that you&#8217;ve created a <tt class="docutils literal"><span class="pre">Task</span></tt> class, the next step is to create and
render the actual HTML form. In Symfony2, this is done by building a form
object and then rendering it in a template. For now, this can all be done
from inside a controller:</p>
<div class="highlight-python"><pre>// src/Acme/TaskBundle/Controller/DefaultController.php
namespace Acme\TaskBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Acme\TaskBundle\Entity\Task;
use Symfony\Component\HttpFoundation\Request;

class DefaultController extends Controller
{
    public function newAction(Request $request)
    {
        // create a task and give it some dummy data for this example
        $task = new Task();
        $task-&gt;setTask('Write a blog post');
        $task-&gt;setDueDate(new \DateTime('tomorrow'));

        $form = $this-&gt;createFormBuilder($task)
            -&gt;add('task', 'text')
            -&gt;add('dueDate', 'date')
            -&gt;getForm();

        return $this-&gt;render('AcmeTaskBundle:Default:new.html.twig', array(
            'form' =&gt; $form-&gt;createView(),
        ));
    }
}</pre>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">This example shows you how to build your form directly in the controller.
Later, in the &#8220;<a class="reference internal" href="#book-form-creating-form-classes"><em>Creating Form Classes</em></a>&#8221; section, you&#8217;ll learn
how to build your form in a standalone class, which is recommended as
your form becomes reusable.</p>
</div>
<p>Creating a form requires relatively little code because Symfony2 form objects
are built with a &#8220;form builder&#8221;. The form builder&#8217;s purpose is to allow you
to write simple form &#8220;recipes&#8221;, and have it do all the heavy-lifting of actually
building the form.</p>
<p>In this example, you&#8217;ve added two fields to your form - <tt class="docutils literal"><span class="pre">task</span></tt> and <tt class="docutils literal"><span class="pre">dueDate</span></tt> -
corresponding to the <tt class="docutils literal"><span class="pre">task</span></tt> and <tt class="docutils literal"><span class="pre">dueDate</span></tt> properties of the <tt class="docutils literal"><span class="pre">Task</span></tt> class.
You&#8217;ve also assigned each a &#8220;type&#8221; (e.g. <tt class="docutils literal"><span class="pre">text</span></tt>, <tt class="docutils literal"><span class="pre">date</span></tt>), which, among
other things, determines which HTML form tag(s) is rendered for that field.</p>
<p>Symfony2 comes with many built-in types that will be discussed shortly
(see <a class="reference internal" href="#book-forms-type-reference"><em>Built-in Field Types</em></a>).</p>
</div>
<div class="section" id="rendering-the-form">
<span id="index-3"></span><h3>Rendering the Form<a class="headerlink" href="#rendering-the-form" title="Permalink to this headline">¶</a></h3>
<p>Now that the form has been created, the next step is to render it. This is
done by passing a special form &#8220;view&#8221; object to your template (notice the
<tt class="docutils literal"><span class="pre">$form-&gt;createView()</span></tt> in the controller above) and using a set of form
helper functions:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/TaskBundle/Resources/views/Default/new.html.twig #}</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;task_new&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="cp">{{</span> <span class="nv">form_enctype</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
    <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- src/Acme/TaskBundle/Resources/views/Default/new.html.php --&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;task_new&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">enctype</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span> <span class="nt">&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>

    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<img alt="../_images/form-simple.png" class="align-center" src="../_images/form-simple.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example assumes that you&#8217;ve created a route called <tt class="docutils literal"><span class="pre">task_new</span></tt>
that points to the <tt class="docutils literal"><span class="pre">AcmeTaskBundle:Default:new</span></tt> controller that
was created earlier.</p>
</div>
<p>That&#8217;s it! By printing <tt class="docutils literal"><span class="pre">form_widget(form)</span></tt>, each field in the form is
rendered, along with a label and error message (if there is one). As easy
as this is, it&#8217;s not very flexible (yet). Usually, you&#8217;ll want to render each
form field individually so you can control how the form looks. You&#8217;ll learn how
to do that in the &#8220;<a class="reference internal" href="#form-rendering-template"><em>Rendering a Form in a Template</em></a>&#8221; section.</p>
<p>Before moving on, notice how the rendered <tt class="docutils literal"><span class="pre">task</span></tt> input field has the value
of the <tt class="docutils literal"><span class="pre">task</span></tt> property from the <tt class="docutils literal"><span class="pre">$task</span></tt> object (i.e. &#8220;Write a blog post&#8221;).
This is the first job of a form: to take data from an object and translate
it into a format that&#8217;s suitable for being rendered in an HTML form.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The form system is smart enough to access the value of the protected
<tt class="docutils literal"><span class="pre">task</span></tt> property via the <tt class="docutils literal"><span class="pre">getTask()</span></tt> and <tt class="docutils literal"><span class="pre">setTask()</span></tt> methods on the
<tt class="docutils literal"><span class="pre">Task</span></tt> class. Unless a property is public, it <em>must</em> have a &#8220;getter&#8221; and
&#8220;setter&#8221; method so that the form component can get and put data onto the
property. For a Boolean property, you can use an &#8220;isser&#8221; method (e.g.
<tt class="docutils literal"><span class="pre">isPublished()</span></tt>) instead of a getter (e.g. <tt class="docutils literal"><span class="pre">getPublished()</span></tt>).</p>
</div>
</div>
<div class="section" id="handling-form-submissions">
<span id="index-4"></span><h3>Handling Form Submissions<a class="headerlink" href="#handling-form-submissions" title="Permalink to this headline">¶</a></h3>
<p>The second job of a form is to translate user-submitted data back to the
properties of an object. To make this happen, the submitted data from the
user must be bound to the form. Add the following functionality to your
controller:</p>
<div class="highlight-python"><pre>// ...

public function newAction(Request $request)
{
    // just setup a fresh $task object (remove the dummy data)
    $task = new Task();

    $form = $this-&gt;createFormBuilder($task)
        -&gt;add('task', 'text')
        -&gt;add('dueDate', 'date')
        -&gt;getForm();

    if ($request-&gt;getMethod() == 'POST') {
        $form-&gt;bind($request);

        if ($form-&gt;isValid()) {
            // perform some action, such as saving the task to the database

            return $this-&gt;redirect($this-&gt;generateUrl('task_success'));
        }
    }

    // ...
}</pre>
</div>
<p class="versionadded">
<span class="versionmodified">New in version 2.1: </span>The <tt class="docutils literal"><span class="pre">bind</span></tt> method was made more flexible in Symfony 2.1. It now accepts
the raw client data (same as before) or a Symfony Request object. This
is preferred over the deprecated <tt class="docutils literal"><span class="pre">bindRequest</span></tt> method.</p>
<p>Now, when submitting the form, the controller binds the submitted data to the
form, which translates that data back to the <tt class="docutils literal"><span class="pre">task</span></tt> and <tt class="docutils literal"><span class="pre">dueDate</span></tt> properties
of the <tt class="docutils literal"><span class="pre">$task</span></tt> object. This all happens via the <tt class="docutils literal"><span class="pre">bind()</span></tt> method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As soon as <tt class="docutils literal"><span class="pre">bind()</span></tt> is called, the submitted data is transferred
to the underlying object immediately. This happens regardless of whether
or not the underlying data is actually valid.</p>
</div>
<p>This controller follows a common pattern for handling forms, and has three
possible paths:</p>
<ol class="arabic simple">
<li>When initially loading the page in a browser, the request method is <tt class="docutils literal"><span class="pre">GET</span></tt>
and the form is simply created and rendered;</li>
<li>When the user submits the form (i.e. the method is <tt class="docutils literal"><span class="pre">POST</span></tt>) with invalid
data (validation is covered in the next section), the form is bound and
then rendered, this time displaying all validation errors;</li>
<li>When the user submits the form with valid data, the form is bound and
you have the opportunity to perform some actions using the <tt class="docutils literal"><span class="pre">$task</span></tt>
object (e.g. persisting it to the database) before redirecting the user
to some other page (e.g. a &#8220;thank you&#8221; or &#8220;success&#8221; page).</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Redirecting a user after a successful form submission prevents the user
from being able to hit &#8220;refresh&#8221; and re-post the data.</p>
</div>
</div>
</div>
<div class="section" id="form-validation">
<span id="index-5"></span><h2>Form Validation<a class="headerlink" href="#form-validation" title="Permalink to this headline">¶</a></h2>
<p>In the previous section, you learned how a form can be submitted with valid
or invalid data. In Symfony2, validation is applied to the underlying object
(e.g. <tt class="docutils literal"><span class="pre">Task</span></tt>). In other words, the question isn&#8217;t whether the &#8220;form&#8221; is
valid, but whether or not the <tt class="docutils literal"><span class="pre">$task</span></tt> object is valid after the form has
applied the submitted data to it. Calling <tt class="docutils literal"><span class="pre">$form-&gt;isValid()</span></tt> is a shortcut
that asks the <tt class="docutils literal"><span class="pre">$task</span></tt> object whether or not it has valid data.</p>
<p>Validation is done by adding a set of rules (called constraints) to a class. To
see this in action, add validation constraints so that the <tt class="docutils literal"><span class="pre">task</span></tt> field cannot
be empty and the <tt class="docutils literal"><span class="pre">dueDate</span></tt> field cannot be empty and must be a valid DateTime
object.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># Acme/TaskBundle/Resources/config/validation.yml</span>
<span class="l-Scalar-Plain">Acme\TaskBundle\Entity\Task</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">task</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">NotBlank</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
        <span class="l-Scalar-Plain">dueDate</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">NotBlank</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">\DateTime</span>
</pre></div>
</div>
</li>
<li><em>Annotations</em><div class="highlight-php-annotations"><div class="highlight"><pre><span class="c1">// Acme/TaskBundle/Entity/Task.php</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints</span> <span class="k">as</span> <span class="nx">Assert</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Task</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Assert\NotBlank()</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="nv">$task</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @Assert\NotBlank()</span>
<span class="sd">     * @Assert\Type(&quot;\DateTime&quot;)</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$dueDate</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- Acme/TaskBundle/Resources/config/validation.xml --&gt;</span>
<span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;Acme\TaskBundle\Entity\Task&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;task&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">name=</span><span class="s">&quot;NotBlank&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;dueDate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">name=</span><span class="s">&quot;NotBlank&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">name=</span><span class="s">&quot;Type&quot;</span><span class="nt">&gt;</span>\DateTime<span class="nt">&lt;/constraint&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/class&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// Acme/TaskBundle/Entity/Task.php</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Mapping\ClassMetadata</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\NotBlank</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\Type</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Task</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">loadValidatorMetadata</span><span class="p">(</span><span class="nx">ClassMetadata</span> <span class="nv">$metadata</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$metadata</span><span class="o">-&gt;</span><span class="na">addPropertyConstraint</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">());</span>

        <span class="nv">$metadata</span><span class="o">-&gt;</span><span class="na">addPropertyConstraint</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">());</span>
        <span class="nv">$metadata</span><span class="o">-&gt;</span><span class="na">addPropertyConstraint</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Type</span><span class="p">(</span><span class="s1">&#39;\DateTime&#39;</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>That&#8217;s it! If you re-submit the form with invalid data, you&#8217;ll see the
corresponding errors printed out with the form.</p>
<div class="sidebar" id="book-forms-html5-validation-disable">
<p class="first sidebar-title">HTML5 Validation</p>
<p>As of HTML5, many browsers can natively enforce certain validation constraints
on the client side. The most common validation is activated by rendering
a <tt class="docutils literal"><span class="pre">required</span></tt> attribute on fields that are required. For browsers that
support HTML5, this will result in a native browser message being displayed
if the user tries to submit the form with that field blank.</p>
<p class="last">Generated forms take full advantage of this new feature by adding sensible
HTML attributes that trigger the validation. The client-side validation,
however, can be disabled by adding the <tt class="docutils literal"><span class="pre">novalidate</span></tt> attribute to the
<tt class="docutils literal"><span class="pre">form</span></tt> tag or <tt class="docutils literal"><span class="pre">formnovalidate</span></tt> to the submit tag. This is especially
useful when you want to test your server-side validation constraints,
but are being prevented by your browser from, for example, submitting
blank fields.</p>
</div>
<p>Validation is a very powerful feature of Symfony2 and has its own
<a class="reference internal" href="validation.html"><em>dedicated chapter</em></a>.</p>
<div class="section" id="validation-groups">
<span id="book-forms-validation-groups"></span><span id="index-6"></span><h3>Validation Groups<a class="headerlink" href="#validation-groups" title="Permalink to this headline">¶</a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you&#8217;re not using <a class="reference internal" href="validation.html#book-validation-validation-groups"><em>validation groups</em></a>,
then you can skip this section.</p>
</div>
<p>If your object takes advantage of <a class="reference internal" href="validation.html#book-validation-validation-groups"><em>validation groups</em></a>,
you&#8217;ll need to specify which validation group(s) your form should use:</p>
<div class="highlight-python"><pre>$form = $this-&gt;createFormBuilder($users, array(
    'validation_groups' =&gt; array('registration'),
))-&gt;add(...);</pre>
</div>
<p>If you&#8217;re creating <a class="reference internal" href="#book-form-creating-form-classes"><em>form classes</em></a> (a
good practice), then you&#8217;ll need to add the following to the <tt class="docutils literal"><span class="pre">setDefaultOptions()</span></tt>
method:</p>
<div class="highlight-python"><pre>use Symfony\Component\OptionsResolver\OptionsResolverInterface;

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'validation_groups' =&gt; array('registration')
    ));
}</pre>
</div>
<p>In both of these cases, <em>only</em> the <tt class="docutils literal"><span class="pre">registration</span></tt> validation group will
be used to validate the underlying object.</p>
</div>
<div class="section" id="groups-based-on-submitted-data">
<h3>Groups based on Submitted Data<a class="headerlink" href="#groups-based-on-submitted-data" title="Permalink to this headline">¶</a></h3>
<p class="versionadded">
<span class="versionmodified">New in version 2.1: </span>The ability to specify a callback or Closure in <tt class="docutils literal"><span class="pre">validation_groups</span></tt>
is new to version 2.1</p>
<p>If you need some advanced logic to determine the validation groups (e.g.
based on submitted data), you can set the <tt class="docutils literal"><span class="pre">validation_groups</span></tt> option
to an array callback, or a <tt class="docutils literal"><span class="pre">Closure</span></tt>:</p>
<div class="highlight-python"><pre>use Symfony\Component\OptionsResolver\OptionsResolverInterface;

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'validation_groups' =&gt; array('Acme\\AcmeBundle\\Entity\\Client', 'determineValidationGroups'),
    ));
}</pre>
</div>
<p>This will call the static method <tt class="docutils literal"><span class="pre">determineValidationGroups()</span></tt> on the
<tt class="docutils literal"><span class="pre">Client</span></tt> class after the form is bound, but before validation is executed.
The Form object is passed as an argument to that method (see next example).
You can also define whole logic inline by using a Closure:</p>
<div class="highlight-python"><pre>use Symfony\Component\Form\FormInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'validation_groups' =&gt; function(FormInterface $form) {
            $data = $form-&gt;getData();
            if (Entity\Client::TYPE_PERSON == $data-&gt;getType()) {
                return array('person')
            } else {
                return array('company');
            }
        },
    ));
}</pre>
</div>
</div>
</div>
<div class="section" id="built-in-field-types">
<span id="book-forms-type-reference"></span><span id="index-7"></span><h2>Built-in Field Types<a class="headerlink" href="#built-in-field-types" title="Permalink to this headline">¶</a></h2>
<p>Symfony comes standard with a large group of field types that cover all of
the common form fields and data types you&#8217;ll encounter:</p>
<div class="section" id="text-fields">
<h3>Text Fields<a class="headerlink" href="#text-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/text.html"><em>text</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/textarea.html"><em>textarea</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/email.html"><em>email</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/integer.html"><em>integer</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/money.html"><em>money</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/number.html"><em>number</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/password.html"><em>password</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/percent.html"><em>percent</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/search.html"><em>search</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/url.html"><em>url</em></a></li>
</ul>
</div>
<div class="section" id="choice-fields">
<h3>Choice Fields<a class="headerlink" href="#choice-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/choice.html"><em>choice</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/entity.html"><em>entity</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/country.html"><em>country</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/language.html"><em>language</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/locale.html"><em>locale</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/timezone.html"><em>timezone</em></a></li>
</ul>
</div>
<div class="section" id="date-and-time-fields">
<h3>Date and Time Fields<a class="headerlink" href="#date-and-time-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/date.html"><em>date</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/datetime.html"><em>datetime</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/time.html"><em>time</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/birthday.html"><em>birthday</em></a></li>
</ul>
</div>
<div class="section" id="other-fields">
<h3>Other Fields<a class="headerlink" href="#other-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/checkbox.html"><em>checkbox</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/file.html"><em>file</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/radio.html"><em>radio</em></a></li>
</ul>
</div>
<div class="section" id="field-groups">
<h3>Field Groups<a class="headerlink" href="#field-groups" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/collection.html"><em>collection</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/repeated.html"><em>repeated</em></a></li>
</ul>
</div>
<div class="section" id="hidden-fields">
<h3>Hidden Fields<a class="headerlink" href="#hidden-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/hidden.html"><em>hidden</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/csrf.html"><em>csrf</em></a></li>
</ul>
</div>
<div class="section" id="base-fields">
<h3>Base Fields<a class="headerlink" href="#base-fields" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../reference/forms/types/field.html"><em>field</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/form.html"><em>form</em></a></li>
</ul>
<p>You can also create your own custom field types. This topic is covered in
the &#8220;<a class="reference internal" href="../cookbook/form/create_custom_field_type.html"><em>How to Create a Custom Form Field Type</em></a>&#8221; article of the cookbook.</p>
</div>
<div class="section" id="field-type-options">
<span id="index-8"></span><h3>Field Type Options<a class="headerlink" href="#field-type-options" title="Permalink to this headline">¶</a></h3>
<p>Each field type has a number of options that can be used to configure it.
For example, the <tt class="docutils literal"><span class="pre">dueDate</span></tt> field is currently being rendered as 3 select
boxes. However, the <a class="reference internal" href="../reference/forms/types/date.html"><em>date field</em></a> can be
configured to be rendered as a single text box (where the user would enter
the date as a string in the box):</p>
<div class="highlight-python"><pre>-&gt;add('dueDate', 'date', array('widget' =&gt; 'single_text'))</pre>
</div>
<img alt="../_images/form-simple2.png" class="align-center" src="../_images/form-simple2.png" />
<p>Each field type has a number of different options that can be passed to it.
Many of these are specific to the field type and details can be found in
the documentation for each type.</p>
<div class="sidebar">
<p class="first sidebar-title">The <tt class="docutils literal"><span class="pre">required</span></tt> option</p>
<p>The most common option is the <tt class="docutils literal"><span class="pre">required</span></tt> option, which can be applied to
any field. By default, the <tt class="docutils literal"><span class="pre">required</span></tt> option is set to <tt class="docutils literal"><span class="pre">true</span></tt>, meaning
that HTML5-ready browsers will apply client-side validation if the field
is left blank. If you don&#8217;t want this behavior, either set the <tt class="docutils literal"><span class="pre">required</span></tt>
option on your field to <tt class="docutils literal"><span class="pre">false</span></tt> or <a class="reference internal" href="#book-forms-html5-validation-disable"><em>disable HTML5 validation</em></a>.</p>
<p>Also note that setting the <tt class="docutils literal"><span class="pre">required</span></tt> option to <tt class="docutils literal"><span class="pre">true</span></tt> will <strong>not</strong>
result in server-side validation to be applied. In other words, if a
user submits a blank value for the field (either with an old browser
or web service, for example), it will be accepted as a valid value unless
you use Symfony&#8217;s <tt class="docutils literal"><span class="pre">NotBlank</span></tt> or <tt class="docutils literal"><span class="pre">NotNull</span></tt> validation constraint.</p>
<p class="last">In other words, the <tt class="docutils literal"><span class="pre">required</span></tt> option is &#8220;nice&#8221;, but true server-side
validation should <em>always</em> be used.</p>
</div>
<div class="sidebar">
<p class="first sidebar-title">The <tt class="docutils literal"><span class="pre">label</span></tt> option</p>
<p>The label for the form field can be set using the <tt class="docutils literal"><span class="pre">label</span></tt> option,
which can be applied to any field:</p>
<div class="highlight-python"><pre>-&gt;add('dueDate', 'date', array(
    'widget' =&gt; 'single_text',
    'label'  =&gt; 'Due Date',
))</pre>
</div>
<p class="last">The label for a field can also be set in the template rendering the
form, see below.</p>
</div>
</div>
</div>
<div class="section" id="field-type-guessing">
<span id="book-forms-field-guessing"></span><span id="index-9"></span><h2>Field Type Guessing<a class="headerlink" href="#field-type-guessing" title="Permalink to this headline">¶</a></h2>
<p>Now that you&#8217;ve added validation metadata to the <tt class="docutils literal"><span class="pre">Task</span></tt> class, Symfony
already knows a bit about your fields. If you allow it, Symfony can &#8220;guess&#8221;
the type of your field and set it up for you. In this example, Symfony can
guess from the validation rules that both the <tt class="docutils literal"><span class="pre">task</span></tt> field is a normal
<tt class="docutils literal"><span class="pre">text</span></tt> field and the <tt class="docutils literal"><span class="pre">dueDate</span></tt> field is a <tt class="docutils literal"><span class="pre">date</span></tt> field:</p>
<div class="highlight-python"><pre>public function newAction()
{
    $task = new Task();

    $form = $this-&gt;createFormBuilder($task)
        -&gt;add('task')
        -&gt;add('dueDate', null, array('widget' =&gt; 'single_text'))
        -&gt;getForm();
}</pre>
</div>
<p>The &#8220;guessing&#8221; is activated when you omit the second argument to the <tt class="docutils literal"><span class="pre">add()</span></tt>
method (or if you pass <tt class="docutils literal"><span class="pre">null</span></tt> to it). If you pass an options array as the
third argument (done for <tt class="docutils literal"><span class="pre">dueDate</span></tt> above), these options are applied to
the guessed field.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">If your form uses a specific validation group, the field type guesser
will still consider <em>all</em> validation constraints when guessing your
field types (including constraints that are not part of the validation
group(s) being used).</p>
</div>
<div class="section" id="field-type-options-guessing">
<span id="index-10"></span><h3>Field Type Options Guessing<a class="headerlink" href="#field-type-options-guessing" title="Permalink to this headline">¶</a></h3>
<p>In addition to guessing the &#8220;type&#8221; for a field, Symfony can also try to guess
the correct values of a number of field options.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When these options are set, the field will be rendered with special HTML
attributes that provide for HTML5 client-side validation. However, it
doesn&#8217;t generate the equivalent server-side constraints (e.g. <tt class="docutils literal"><span class="pre">Assert\MaxLength</span></tt>).
And though you&#8217;ll need to manually add your server-side validation, these
field type options can then be guessed from that information.</p>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">required</span></tt>: The <tt class="docutils literal"><span class="pre">required</span></tt> option can be guessed based on the validation
rules (i.e. is the field <tt class="docutils literal"><span class="pre">NotBlank</span></tt> or <tt class="docutils literal"><span class="pre">NotNull</span></tt>) or the Doctrine metadata
(i.e. is the field <tt class="docutils literal"><span class="pre">nullable</span></tt>). This is very useful, as your client-side
validation will automatically match your validation rules.</li>
<li><tt class="docutils literal"><span class="pre">max_length</span></tt>: If the field is some sort of text field, then the <tt class="docutils literal"><span class="pre">max_length</span></tt>
option can be guessed from the validation constraints (if <tt class="docutils literal"><span class="pre">MaxLength</span></tt> or <tt class="docutils literal"><span class="pre">Max</span></tt>
is used) or from the Doctrine metadata (via the field&#8217;s length).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These field options are <em>only</em> guessed if you&#8217;re using Symfony to guess
the field type (i.e. omit or pass <tt class="docutils literal"><span class="pre">null</span></tt> as the second argument to <tt class="docutils literal"><span class="pre">add()</span></tt>).</p>
</div>
<p>If you&#8217;d like to change one of the guessed values, you can override it by
passing the option in the options field array:</p>
<div class="highlight-python"><pre>-&gt;add('task', null, array('max_length' =&gt; 4))</pre>
</div>
</div>
</div>
<div class="section" id="rendering-a-form-in-a-template">
<span id="form-rendering-template"></span><span id="index-11"></span><h2>Rendering a Form in a Template<a class="headerlink" href="#rendering-a-form-in-a-template" title="Permalink to this headline">¶</a></h2>
<p>So far, you&#8217;ve seen how an entire form can be rendered with just one line
of code. Of course, you&#8217;ll usually need much more flexibility when rendering:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/TaskBundle/Resources/views/Default/new.html.twig #}</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;task_new&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="cp">{{</span> <span class="nv">form_enctype</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
    <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

    <span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.task</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.dueDate</span><span class="o">)</span> <span class="cp">}}</span>

    <span class="cp">{{</span> <span class="nv">form_rest</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- src/Acme/TaskBundle/Resources/views/Default/newAction.html.php --&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;task_new&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">enctype</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>

    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">row</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">row</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;dueDate&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>

    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">rest</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>

    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Let&#8217;s take a look at each part:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">form_enctype(form)</span></tt> - If at least one field is a file upload field, this
renders the obligatory <tt class="docutils literal"><span class="pre">enctype=&quot;multipart/form-data&quot;</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">form_errors(form)</span></tt> - Renders any errors global to the whole form
(field-specific errors are displayed next to each field);</li>
<li><tt class="docutils literal"><span class="pre">form_row(form.dueDate)</span></tt> - Renders the label, any errors, and the HTML
form widget for the given field (e.g. <tt class="docutils literal"><span class="pre">dueDate</span></tt>) inside, by default, a
<tt class="docutils literal"><span class="pre">div</span></tt> element;</li>
<li><tt class="docutils literal"><span class="pre">form_rest(form)</span></tt> - Renders any fields that have not yet been rendered.
It&#8217;s usually a good idea to place a call to this helper at the bottom of
each form (in case you forgot to output a field or don&#8217;t want to bother
manually rendering hidden fields). This helper is also useful for taking
advantage of the automatic <a class="reference internal" href="#forms-csrf"><em>CSRF Protection</em></a>.</li>
</ul>
<p>The majority of the work is done by the <tt class="docutils literal"><span class="pre">form_row</span></tt> helper, which renders
the label, errors and HTML form widget of each field inside a <tt class="docutils literal"><span class="pre">div</span></tt> tag
by default. In the <a class="reference internal" href="#form-theming"><em>Form Theming</em></a> section, you&#8217;ll learn how the <tt class="docutils literal"><span class="pre">form_row</span></tt>
output can be customized on many different levels.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>You can access the current data of your form via <tt class="docutils literal"><span class="pre">form.vars.value</span></tt>:</p>
<div class="last configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form.vars.value.task</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getTask</span><span class="p">()</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="rendering-each-field-by-hand">
<span id="index-12"></span><h3>Rendering each Field by Hand<a class="headerlink" href="#rendering-each-field-by-hand" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">form_row</span></tt> helper is great because you can very quickly render each
field of your form (and the markup used for the &#8220;row&#8221; can be customized as
well). But since life isn&#8217;t always so simple, you can also render each field
entirely by hand. The end-product of the following is the same as when you
used the <tt class="docutils literal"><span class="pre">form_row</span></tt> helper:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

<span class="nt">&lt;div&gt;</span>
    <span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form.task</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form.task</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form.task</span><span class="o">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div&gt;</span>
    <span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form.dueDate</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form.dueDate</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form.dueDate</span><span class="o">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">{{</span> <span class="nv">form_rest</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>

<span class="nt">&lt;div&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;dueDate&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;dueDate&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;dueDate&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">rest</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>If the auto-generated label for a field isn&#8217;t quite right, you can explicitly
specify it:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form.task</span><span class="o">,</span> <span class="s1">&#39;Task Description&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">],</span> <span class="s1">&#39;Task Description&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Some field types have additional rendering options that can be passed
to the widget. These options are documented with each type, but one common
options is <tt class="docutils literal"><span class="pre">attr</span></tt>, which allows you to modify attributes on the form element.
The following would add the <tt class="docutils literal"><span class="pre">task_field</span></tt> class to the rendered input text
field:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form.task</span><span class="o">,</span> <span class="o">{</span> <span class="s1">&#39;attr&#39;</span><span class="o">:</span> <span class="o">{</span><span class="s1">&#39;class&#39;</span><span class="o">:</span> <span class="s1">&#39;task_field&#39;</span><span class="o">}</span> <span class="o">})</span> <span class="cp">}}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">],</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;attr&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;task_field&#39;</span><span class="p">),</span>
<span class="p">))</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>If you need to render form fields &#8220;by hand&#8221; then you can access individual
values for fields such as the <tt class="docutils literal"><span class="pre">id</span></tt>, <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">label</span></tt>. For example
to get the <tt class="docutils literal"><span class="pre">id</span></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form.task.vars.id</span> <span class="cp">}}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>To get the value used for the form field&#8217;s name attribute you need to use
the <tt class="docutils literal"><span class="pre">full_name</span></tt> value:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form.task.vars.full_name</span> <span class="cp">}}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;full_name&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="twig-template-function-reference">
<h3>Twig Template Function Reference<a class="headerlink" href="#twig-template-function-reference" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re using Twig, a full reference of the form rendering functions is
available in the <a class="reference internal" href="../reference/forms/twig_reference.html"><em>reference manual</em></a>.
Read this to know everything about the helpers available and the options
that can be used with each.</p>
</div>
</div>
<div class="section" id="creating-form-classes">
<span id="book-form-creating-form-classes"></span><span id="index-13"></span><h2>Creating Form Classes<a class="headerlink" href="#creating-form-classes" title="Permalink to this headline">¶</a></h2>
<p>As you&#8217;ve seen, a form can be created and used directly in a controller.
However, a better practice is to build the form in a separate, standalone PHP
class, which can then be reused anywhere in your application. Create a new class
that will house the logic for building the task form:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/TaskBundle/Form/Type/TaskType.php</span>
<span class="k">namespace</span> <span class="nx">Acme\TaskBundle\Form\Type</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Form\AbstractType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormBuilderInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TaskType</span> <span class="k">extends</span> <span class="nx">AbstractType</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">buildForm</span><span class="p">(</span><span class="nx">FormBuilderInterface</span> <span class="nv">$builder</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">);</span>
        <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;widget&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;single_text&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getName</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;task&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This new class contains all the directions needed to create the task form
(note that the <tt class="docutils literal"><span class="pre">getName()</span></tt> method should return a unique identifier for this
form &#8220;type&#8221;). It can be used to quickly build a form object in the controller:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/TaskBundle/Controller/DefaultController.php</span>

<span class="c1">// add this new use statement at the top of the class</span>
<span class="k">use</span> <span class="nx">Acme\TaskBundle\Form\Type\TaskType</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">newAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$task</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span>
    <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createForm</span><span class="p">(</span><span class="k">new</span> <span class="nx">TaskType</span><span class="p">(),</span> <span class="nv">$task</span><span class="p">);</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Placing the form logic into its own class means that the form can be easily
reused elsewhere in your project. This is the best way to create forms, but
the choice is ultimately up to you.</p>
<div class="sidebar" id="book-forms-data-class">
<p class="first sidebar-title">Setting the <tt class="docutils literal"><span class="pre">data_class</span></tt></p>
<p>Every form needs to know the name of the class that holds the underlying
data (e.g. <tt class="docutils literal"><span class="pre">Acme\TaskBundle\Entity\Task</span></tt>). Usually, this is just guessed
based off of the object passed to the second argument to <tt class="docutils literal"><span class="pre">createForm</span></tt>
(i.e. <tt class="docutils literal"><span class="pre">$task</span></tt>). Later, when you begin embedding forms, this will no
longer be sufficient. So, while not always necessary, it&#8217;s generally a
good idea to explicitly specify the <tt class="docutils literal"><span class="pre">data_class</span></tt> option by adding the
following to your form type class:</p>
<div class="last highlight-python"><pre>use Symfony\Component\OptionsResolver\OptionsResolverInterface;

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'data_class' =&gt; 'Acme\TaskBundle\Entity\Task',
    ));
}</pre>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>When mapping forms to objects, all fields are mapped. Any fields on the
form that do not exist on the mapped object will cause an exception to
be thrown.</p>
<p>In cases where you need extra fields in the form (for example: a &#8220;do you
agree with these terms&#8221; checkbox) that will not be mapped to the underlying
object, you need to set the property_path option to <tt class="docutils literal"><span class="pre">false</span></tt>:</p>
<div class="highlight-python"><pre>use Symfony\Component\Form\FormBuilderInterface;

public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder-&gt;add('task');
    $builder-&gt;add('dueDate', null, array('property_path' =&gt; false));
}</pre>
</div>
<p>Additionally, if there are any fields on the form that aren&#8217;t included in
the submitted data, those fields will be explicitly set to <tt class="docutils literal"><span class="pre">null</span></tt>.</p>
<p>The field data can be accessed in a controller with:</p>
<div class="last highlight-python"><pre>$form-&gt;get('dueDate')-&gt;getData();</pre>
</div>
</div>
</div>
<div class="section" id="forms-and-doctrine">
<span id="index-14"></span><h2>Forms and Doctrine<a class="headerlink" href="#forms-and-doctrine" title="Permalink to this headline">¶</a></h2>
<p>The goal of a form is to translate data from an object (e.g. <tt class="docutils literal"><span class="pre">Task</span></tt>) to an
HTML form and then translate user-submitted data back to the original object. As
such, the topic of persisting the <tt class="docutils literal"><span class="pre">Task</span></tt> object to the database is entirely
unrelated to the topic of forms. But, if you&#8217;ve configured the <tt class="docutils literal"><span class="pre">Task</span></tt> class
to be persisted via Doctrine (i.e. you&#8217;ve added
<a class="reference internal" href="doctrine.html#book-doctrine-adding-mapping"><em>mapping metadata</em></a> for it), then persisting
it after a form submission can be done when the form is valid:</p>
<div class="highlight-python"><pre>if ($form-&gt;isValid()) {
    $em = $this-&gt;getDoctrine()-&gt;getManager();
    $em-&gt;persist($task);
    $em-&gt;flush();

    return $this-&gt;redirect($this-&gt;generateUrl('task_success'));
}</pre>
</div>
<p>If, for some reason, you don&#8217;t have access to your original <tt class="docutils literal"><span class="pre">$task</span></tt> object,
you can fetch it from the form:</p>
<div class="highlight-python"><pre>$task = $form-&gt;getData();</pre>
</div>
<p>For more information, see the <a class="reference internal" href="doctrine.html"><em>Doctrine ORM chapter</em></a>.</p>
<p>The key thing to understand is that when the form is bound, the submitted
data is transferred to the underlying object immediately. If you want to
persist that data, you simply need to persist the object itself (which already
contains the submitted data).</p>
</div>
<div class="section" id="embedded-forms">
<span id="index-15"></span><h2>Embedded Forms<a class="headerlink" href="#embedded-forms" title="Permalink to this headline">¶</a></h2>
<p>Often, you&#8217;ll want to build a form that will include fields from many different
objects. For example, a registration form may contain data belonging to
a <tt class="docutils literal"><span class="pre">User</span></tt> object as well as many <tt class="docutils literal"><span class="pre">Address</span></tt> objects. Fortunately, this
is easy and natural with the form component.</p>
<div class="section" id="embedding-a-single-object">
<h3>Embedding a Single Object<a class="headerlink" href="#embedding-a-single-object" title="Permalink to this headline">¶</a></h3>
<p>Suppose that each <tt class="docutils literal"><span class="pre">Task</span></tt> belongs to a simple <tt class="docutils literal"><span class="pre">Category</span></tt> object. Start,
of course, by creating the <tt class="docutils literal"><span class="pre">Category</span></tt> object:</p>
<div class="highlight-python"><pre>// src/Acme/TaskBundle/Entity/Category.php
namespace Acme\TaskBundle\Entity;

use Symfony\Component\Validator\Constraints as Assert;

class Category
{
    /**
     * @Assert\NotBlank()
     */
    public $name;
}</pre>
</div>
<p>Next, add a new <tt class="docutils literal"><span class="pre">category</span></tt> property to the <tt class="docutils literal"><span class="pre">Task</span></tt> class:</p>
<div class="highlight-python"><pre>// ...

class Task
{
    // ...

    /**
     * @Assert\Type(type="Acme\TaskBundle\Entity\Category")
     */
    protected $category;

    // ...

    public function getCategory()
    {
        return $this-&gt;category;
    }

    public function setCategory(Category $category = null)
    {
        $this-&gt;category = $category;
    }
}</pre>
</div>
<p>Now that your application has been updated to reflect the new requirements,
create a form class so that a <tt class="docutils literal"><span class="pre">Category</span></tt> object can be modified by the user:</p>
<div class="highlight-python"><pre>// src/Acme/TaskBundle/Form/Type/CategoryType.php
namespace Acme\TaskBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class CategoryType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder-&gt;add('name');
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver-&gt;setDefaults(array(
            'data_class' =&gt; 'Acme\TaskBundle\Entity\Category',
        ));
    }

    public function getName()
    {
        return 'category';
    }
}</pre>
</div>
<p>The end goal is to allow the <tt class="docutils literal"><span class="pre">Category</span></tt> of a <tt class="docutils literal"><span class="pre">Task</span></tt> to be modified right
inside the task form itself. To accomplish this, add a <tt class="docutils literal"><span class="pre">category</span></tt> field
to the <tt class="docutils literal"><span class="pre">TaskType</span></tt> object whose type is an instance of the new <tt class="docutils literal"><span class="pre">CategoryType</span></tt>
class:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\Form\FormBuilderInterface</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">buildForm</span><span class="p">(</span><span class="nx">FormBuilderInterface</span> <span class="nv">$builder</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">CategoryType</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The fields from <tt class="docutils literal"><span class="pre">CategoryType</span></tt> can now be rendered alongside those from
the <tt class="docutils literal"><span class="pre">TaskType</span></tt> class. To activate validation on CategoryType, add
the <tt class="docutils literal"><span class="pre">cascade_validation</span></tt> option:</p>
<div class="highlight-python"><pre>public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'data_class' =&gt; 'Acme\TaskBundle\Entity\Category',
        'cascade_validation' =&gt; true,
    ));
}</pre>
</div>
<p>Render the <tt class="docutils literal"><span class="pre">Category</span></tt> fields in the same way
as the original <tt class="docutils literal"><span class="pre">Task</span></tt> fields:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# ... #}</span>

<span class="nt">&lt;h3&gt;</span>Category<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;category&quot;</span><span class="nt">&gt;</span>
    <span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.category.name</span><span class="o">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">{{</span> <span class="nv">form_rest</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c">{# ... #}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- ... --&gt;</span>

<span class="nt">&lt;h3&gt;</span>Category<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;category&quot;</span><span class="nt">&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">row</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">rest</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>When the user submits the form, the submitted data for the <tt class="docutils literal"><span class="pre">Category</span></tt> fields
are used to construct an instance of <tt class="docutils literal"><span class="pre">Category</span></tt>, which is then set on the
<tt class="docutils literal"><span class="pre">category</span></tt> field of the <tt class="docutils literal"><span class="pre">Task</span></tt> instance.</p>
<p>The <tt class="docutils literal"><span class="pre">Category</span></tt> instance is accessible naturally via <tt class="docutils literal"><span class="pre">$task-&gt;getCategory()</span></tt>
and can be persisted to the database or used however you need.</p>
</div>
<div class="section" id="embedding-a-collection-of-forms">
<h3>Embedding a Collection of Forms<a class="headerlink" href="#embedding-a-collection-of-forms" title="Permalink to this headline">¶</a></h3>
<p>You can also embed a collection of forms into one form (imagine a <tt class="docutils literal"><span class="pre">Category</span></tt>
form with many <tt class="docutils literal"><span class="pre">Product</span></tt> sub-forms). This is done by using the <tt class="docutils literal"><span class="pre">collection</span></tt>
field type.</p>
<p>For more information see the &#8220;<a class="reference internal" href="../cookbook/form/form_collections.html"><em>How to Embed a Collection of Forms</em></a>&#8221; cookbook
entry and  the <a class="reference internal" href="../reference/forms/types/collection.html"><em>collection</em></a> field type reference.</p>
</div>
</div>
<div class="section" id="form-theming">
<span id="index-16"></span><span id="id1"></span><h2>Form Theming<a class="headerlink" href="#form-theming" title="Permalink to this headline">¶</a></h2>
<p>Every part of how a form is rendered can be customized. You&#8217;re free to change
how each form &#8220;row&#8221; renders, change the markup used to render errors, or
even customize how a <tt class="docutils literal"><span class="pre">textarea</span></tt> tag should be rendered. Nothing is off-limits,
and different customizations can be used in different places.</p>
<p>Symfony uses templates to render each and every part of a form, such as
<tt class="docutils literal"><span class="pre">label</span></tt> tags, <tt class="docutils literal"><span class="pre">input</span></tt> tags, error messages and everything else.</p>
<p>In Twig, each form &#8220;fragment&#8221; is represented by a Twig block. To customize
any part of how a form renders, you just need to override the appropriate block.</p>
<p>In PHP, each form &#8220;fragment&#8221; is rendered via an individual template file.
To customize any part of how a form renders, you just need to override the
existing template by creating a new one.</p>
<p>To understand how this works, let&#8217;s customize the <tt class="docutils literal"><span class="pre">form_row</span></tt> fragment and
add a class attribute to the <tt class="docutils literal"><span class="pre">div</span></tt> element that surrounds each row. To
do this, create a new template file that will store the new markup:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/TaskBundle/Resources/views/Form/fields.html.twig #}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">field_row</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">spaceless</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form_row&quot;</span><span class="nt">&gt;</span>
        <span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
        <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
        <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endspaceless</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">field_row</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- src/Acme/TaskBundle/Resources/views/Form/field_row.html.php --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form_row&quot;</span><span class="nt">&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="nv">$form</span><span class="p">,</span> <span class="nv">$label</span><span class="p">)</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$form</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>The <tt class="docutils literal"><span class="pre">field_row</span></tt> form fragment is used when rendering most fields via the
<tt class="docutils literal"><span class="pre">form_row</span></tt> function. To tell the form component to use your new <tt class="docutils literal"><span class="pre">field_row</span></tt>
fragment defined above, add the following to the top of the template that
renders the form:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><pre>{# src/Acme/TaskBundle/Resources/views/Default/new.html.twig #}
{% form_theme form 'AcmeTaskBundle:Form:fields.html.twig' %}

{% form_theme form 'AcmeTaskBundle:Form:fields.html.twig' 'AcmeTaskBundle:Form:fields2.html.twig' %}

&lt;form ...&gt;</pre>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><pre>&lt;!-- src/Acme/TaskBundle/Resources/views/Default/new.html.php --&gt;
&lt;?php $view['form']-&gt;setTheme($form, array('AcmeTaskBundle:Form')) ?&gt;

&lt;?php $view['form']-&gt;setTheme($form, array('AcmeTaskBundle:Form', 'AcmeTaskBundle:Form')) ?&gt;

&lt;form ...&gt;</pre>
</div>
</li>
</ul>
</div>
<p>The <tt class="docutils literal"><span class="pre">form_theme</span></tt> tag (in Twig) &#8220;imports&#8221; the fragments defined in the given
template and uses them when rendering the form. In other words, when the
<tt class="docutils literal"><span class="pre">form_row</span></tt> function is called later in this template, it will use the <tt class="docutils literal"><span class="pre">field_row</span></tt>
block from your custom theme (instead of the default <tt class="docutils literal"><span class="pre">field_row</span></tt> block
that ships with Symfony).</p>
<p>Your custom theme does not have to override all the blocks. When rendering a block
which is not overridden in your custom theme, the theming engine will fall back
to the global theme (defined at the bundle level).</p>
<p>If several custom themes are provided they will be searched in the listed order
before falling back to the global theme.</p>
<p>To customize any portion of a form, you just need to override the appropriate
fragment. Knowing exactly which block or file to override is the subject of
the next section.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.1: </span>An alternate Twig syntax for <tt class="docutils literal"><span class="pre">form_theme</span></tt> has been introduced in 2.1. It accepts
any valid Twig expression (the most noticeable difference is using an array when
using multiple themes).<div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/TaskBundle/Resources/views/Default/new.html.twig #}</span>

<span class="cp">{%</span> <span class="k">form_theme</span> <span class="nv">form</span> <span class="k">with</span> <span class="s1">&#39;AcmeTaskBundle:Form:fields.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">form_theme</span> <span class="nv">form</span> <span class="k">with</span> <span class="o">[</span><span class="s1">&#39;AcmeTaskBundle:Form:fields.html.twig&#39;</span><span class="o">,</span> <span class="s1">&#39;AcmeTaskBundle:Form:fields2.html.twig&#39;</span><span class="o">]</span> <span class="cp">%}</span>
</pre></div>
</div>
</p>
<p>For a more extensive discussion, see <a class="reference internal" href="../cookbook/form/form_customization.html"><em>How to customize Form Rendering</em></a>.</p>
<div class="section" id="form-fragment-naming">
<span id="form-template-blocks"></span><span id="index-17"></span><h3>Form Fragment Naming<a class="headerlink" href="#form-fragment-naming" title="Permalink to this headline">¶</a></h3>
<p>In Symfony, every part of a form that is rendered - HTML form elements, errors,
labels, etc - is defined in a base theme, which is a collection of blocks
in Twig and a collection of template files in PHP.</p>
<p>In Twig, every block needed is defined in a single template file (<a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig">form_div_layout.html.twig</a>)
that lives inside the <a class="reference external" href="https://github.com/symfony/symfony/tree/master/src/Symfony/Bridge/Twig">Twig Bridge</a>. Inside this file, you can see every block
needed to render a form and every default field type.</p>
<p>In PHP, the fragments are individual template files. By default they are located in
the <cite>Resources/views/Form</cite> directory of the framework bundle (<a class="reference external" href="https://github.com/symfony/symfony/tree/master/src/Symfony/Bundle/FrameworkBundle/Resources/views/Form">view on GitHub</a>).</p>
<p>Each fragment name follows the same basic pattern and is broken up into two pieces,
separated by a single underscore character (<tt class="docutils literal"><span class="pre">_</span></tt>). A few examples are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">field_row</span></tt> - used by <tt class="docutils literal"><span class="pre">form_row</span></tt> to render most fields;</li>
<li><tt class="docutils literal"><span class="pre">textarea_widget</span></tt> - used by <tt class="docutils literal"><span class="pre">form_widget</span></tt> to render a <tt class="docutils literal"><span class="pre">textarea</span></tt> field
type;</li>
<li><tt class="docutils literal"><span class="pre">field_errors</span></tt> - used by <tt class="docutils literal"><span class="pre">form_errors</span></tt> to render errors for a field;</li>
</ul>
<p>Each fragment follows the same basic pattern: <tt class="docutils literal"><span class="pre">type_part</span></tt>. The <tt class="docutils literal"><span class="pre">type</span></tt> portion
corresponds to the field <em>type</em> being rendered (e.g. <tt class="docutils literal"><span class="pre">textarea</span></tt>, <tt class="docutils literal"><span class="pre">checkbox</span></tt>,
<tt class="docutils literal"><span class="pre">date</span></tt>, etc) whereas the <tt class="docutils literal"><span class="pre">part</span></tt> portion corresponds to <em>what</em> is being
rendered (e.g. <tt class="docutils literal"><span class="pre">label</span></tt>, <tt class="docutils literal"><span class="pre">widget</span></tt>, <tt class="docutils literal"><span class="pre">errors</span></tt>, etc). By default, there
are 4 possible <em>parts</em> of a form that can be rendered:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="27%" />
<col width="59%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">label</span></tt></td>
<td>(e.g. <tt class="docutils literal"><span class="pre">field_label</span></tt>)</td>
<td>renders the field&#8217;s label</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">widget</span></tt></td>
<td>(e.g. <tt class="docutils literal"><span class="pre">field_widget</span></tt>)</td>
<td>renders the field&#8217;s HTML representation</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">errors</span></tt></td>
<td>(e.g. <tt class="docutils literal"><span class="pre">field_errors</span></tt>)</td>
<td>renders the field&#8217;s errors</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">row</span></tt></td>
<td>(e.g. <tt class="docutils literal"><span class="pre">field_row</span></tt>)</td>
<td>renders the field&#8217;s entire row (label, widget &amp; errors)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are actually 3 other <em>parts</em>  - <tt class="docutils literal"><span class="pre">rows</span></tt>, <tt class="docutils literal"><span class="pre">rest</span></tt>, and <tt class="docutils literal"><span class="pre">enctype</span></tt> -
but you should rarely if ever need to worry about overriding them.</p>
</div>
<p>By knowing the field type (e.g. <tt class="docutils literal"><span class="pre">textarea</span></tt>) and which part you want to
customize (e.g. <tt class="docutils literal"><span class="pre">widget</span></tt>), you can construct the fragment name that needs
to be overridden (e.g. <tt class="docutils literal"><span class="pre">textarea_widget</span></tt>).</p>
</div>
<div class="section" id="template-fragment-inheritance">
<span id="index-18"></span><h3>Template Fragment Inheritance<a class="headerlink" href="#template-fragment-inheritance" title="Permalink to this headline">¶</a></h3>
<p>In some cases, the fragment you want to customize will appear to be missing.
For example, there is no <tt class="docutils literal"><span class="pre">textarea_errors</span></tt> fragment in the default themes
provided with Symfony. So how are the errors for a textarea field rendered?</p>
<p>The answer is: via the <tt class="docutils literal"><span class="pre">field_errors</span></tt> fragment. When Symfony renders the errors
for a textarea type, it looks first for a <tt class="docutils literal"><span class="pre">textarea_errors</span></tt> fragment before
falling back to the <tt class="docutils literal"><span class="pre">field_errors</span></tt> fragment. Each field type has a <em>parent</em>
type (the parent type of <tt class="docutils literal"><span class="pre">textarea</span></tt> is <tt class="docutils literal"><span class="pre">field</span></tt>), and Symfony uses the
fragment for the parent type if the base fragment doesn&#8217;t exist.</p>
<p>So, to override the errors for <em>only</em> <tt class="docutils literal"><span class="pre">textarea</span></tt> fields, copy the
<tt class="docutils literal"><span class="pre">field_errors</span></tt> fragment, rename it to <tt class="docutils literal"><span class="pre">textarea_errors</span></tt> and customize it. To
override the default error rendering for <em>all</em> fields, copy and customize the
<tt class="docutils literal"><span class="pre">field_errors</span></tt> fragment directly.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The &#8220;parent&#8221; type of each field type is available in the
<a class="reference internal" href="../reference/forms/types.html"><em>form type reference</em></a> for each field type.</p>
</div>
</div>
<div class="section" id="global-form-theming">
<span id="index-19"></span><h3>Global Form Theming<a class="headerlink" href="#global-form-theming" title="Permalink to this headline">¶</a></h3>
<p>In the above example, you used the <tt class="docutils literal"><span class="pre">form_theme</span></tt> helper (in Twig) to &#8220;import&#8221;
the custom form fragments into <em>just</em> that form. You can also tell Symfony
to import form customizations across your entire project.</p>
<div class="section" id="twig">
<h4>Twig<a class="headerlink" href="#twig" title="Permalink to this headline">¶</a></h4>
<p>To automatically include the customized blocks from the <tt class="docutils literal"><span class="pre">fields.html.twig</span></tt>
template created earlier in <em>all</em> templates, modify your application configuration
file:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">twig</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">form</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="s">&#39;AcmeTaskBundle:Form:fields.html.twig&#39;</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><pre>&lt;!-- app/config/config.xml --&gt;
&lt;twig:config ...&gt;
        &lt;twig:form&gt;
            &lt;resource&gt;AcmeTaskBundle:Form:fields.html.twig&lt;/resource&gt;
        &lt;/twig:form&gt;
        &lt;!-- ... --&gt;
&lt;/twig:config&gt;</pre>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/config.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;twig&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;AcmeTaskBundle:Form:fields.html.twig&#39;</span><span class="p">,</span>
     <span class="p">))</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Any blocks inside the <tt class="docutils literal"><span class="pre">fields.html.twig</span></tt> template are now used globally
to define form output.</p>
<div class="sidebar">
<p class="first sidebar-title">Customizing Form Output all in a Single File with Twig</p>
<p>In Twig, you can also customize a form block right inside the template
where that customization is needed:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;::base.html.twig&#39;</span> <span class="cp">%}</span>

<span class="c">{# import &quot;_self&quot; as the form theme #}</span>
<span class="cp">{%</span> <span class="k">form_theme</span> <span class="nv">form</span> <span class="p">_</span><span class="nv">self</span> <span class="cp">%}</span>

<span class="c">{# make the form fragment customization #}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">field_row</span> <span class="cp">%}</span>
    <span class="c">{# custom field row output #}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">field_row</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
    <span class="c">{# ... #}</span>

    <span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.task</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">form_theme</span> <span class="pre">form</span> <span class="pre">_self</span> <span class="pre">%}</span></tt> tag allows form blocks to be customized
directly inside the template that will use those customizations. Use
this method to quickly make form output customizations that will only
ever be needed in a single template.</p>
<div class="last admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">This <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">form_theme</span> <span class="pre">form</span> <span class="pre">_self</span> <span class="pre">%}</span></tt> functionality will <em>only</em> work
if your template extends another. If your template does not, you
must point <tt class="docutils literal"><span class="pre">form_theme</span></tt> to a separate template.</p>
</div>
</div>
</div>
<div class="section" id="php">
<h4>PHP<a class="headerlink" href="#php" title="Permalink to this headline">¶</a></h4>
<p>To automatically include the customized templates from the <tt class="docutils literal"><span class="pre">Acme/TaskBundle/Resources/views/Form</span></tt>
directory created earlier in <em>all</em> templates, modify your application configuration
file:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">framework</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">templating</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">form</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
                <span class="p-Indicator">-</span> <span class="s">&#39;AcmeTaskBundle:Form&#39;</span>
<span class="c1"># ...</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><pre>&lt;!-- app/config/config.xml --&gt;
&lt;framework:config ...&gt;
    &lt;framework:templating&gt;
        &lt;framework:form&gt;
            &lt;resource&gt;AcmeTaskBundle:Form&lt;/resource&gt;
        &lt;/framework:form&gt;
    &lt;/framework:templating&gt;
    &lt;!-- ... --&gt;
&lt;/framework:config&gt;</pre>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/config.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;framework&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;templating&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;form&#39;</span> <span class="o">=&gt;</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;AcmeTaskBundle:Form&#39;</span><span class="p">,</span>
     <span class="p">)))</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Any fragments inside the <tt class="docutils literal"><span class="pre">Acme/TaskBundle/Resources/views/Form</span></tt> directory
are now used globally to define form output.</p>
</div>
</div>
</div>
<div class="section" id="csrf-protection">
<span id="forms-csrf"></span><span id="index-20"></span><h2>CSRF Protection<a class="headerlink" href="#csrf-protection" title="Permalink to this headline">¶</a></h2>
<p>CSRF - or <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> - is a method by which a malicious
user attempts to make your legitimate users unknowingly submit data that
they don&#8217;t intend to submit. Fortunately, CSRF attacks can be prevented by
using a CSRF token inside your forms.</p>
<p>The good news is that, by default, Symfony embeds and validates CSRF tokens
automatically for you. This means that you can take advantage of the CSRF
protection without doing anything. In fact, every form in this chapter has
taken advantage of the CSRF protection!</p>
<p>CSRF protection works by adding a hidden field to your form - called <tt class="docutils literal"><span class="pre">_token</span></tt>
by default - that contains a value that only you and your user knows. This
ensures that the user - not some other entity - is submitting the given data.
Symfony automatically validates the presence and accuracy of this token.</p>
<p>The <tt class="docutils literal"><span class="pre">_token</span></tt> field is a hidden field and will be automatically rendered
if you include the <tt class="docutils literal"><span class="pre">form_rest()</span></tt> function in your template, which ensures
that all un-rendered fields are output.</p>
<p>The CSRF token can be customized on a form-by-form basis. For example:</p>
<div class="highlight-python"><pre>use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class TaskType extends AbstractType
{
    // ...

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver-&gt;setDefaults(array(
            'data_class'      =&gt; 'Acme\TaskBundle\Entity\Task',
            'csrf_protection' =&gt; true,
            'csrf_field_name' =&gt; '_token',
            // a unique key to help generate the secret token
            'intention'       =&gt; 'task_item',
        ));
    }

    // ...
}</pre>
</div>
<p>To disable CSRF protection, set the <tt class="docutils literal"><span class="pre">csrf_protection</span></tt> option to false.
Customizations can also be made globally in your project. For more information,
see the <a class="reference internal" href="../reference/configuration/framework.html#reference-framework-form"><em>form configuration reference</em></a>
section.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">intention</span></tt> option is optional but greatly enhances the security of
the generated token by making it different for each form.</p>
</div>
</div>
<div class="section" id="using-a-form-without-a-class">
<h2>Using a Form without a Class<a class="headerlink" href="#using-a-form-without-a-class" title="Permalink to this headline">¶</a></h2>
<p>In most cases, a form is tied to an object, and the fields of the form get
and store their data on the properties of that object. This is exactly what
you&#8217;ve seen so far in this chapter with the <cite>Task</cite> class.</p>
<p>But sometimes, you may just want to use a form without a class, and get back
an array of the submitted data. This is actually really easy:</p>
<div class="highlight-python"><pre>// make sure you've imported the Request namespace above the class
use Symfony\Component\HttpFoundation\Request
// ...

public function contactAction(Request $request)
{
    $defaultData = array('message' =&gt; 'Type your message here');
    $form = $this-&gt;createFormBuilder($defaultData)
        -&gt;add('name', 'text')
        -&gt;add('email', 'email')
        -&gt;add('message', 'textarea')
        -&gt;getForm();

        if ($request-&gt;getMethod() == 'POST') {
            $form-&gt;bind($request);

            // data is an array with "name", "email", and "message" keys
            $data = $form-&gt;getData();
        }

    // ... render the form
}</pre>
</div>
<p>By default, a form actually assumes that you want to work with arrays of
data, instead of an object. There are exactly two ways that you can change
this behavior and tie the form to an object instead:</p>
<ol class="arabic simple">
<li>Pass an object when creating the form (as the first argument to <tt class="docutils literal"><span class="pre">createFormBuilder</span></tt>
or the second argument to <tt class="docutils literal"><span class="pre">createForm</span></tt>);</li>
<li>Declare the <tt class="docutils literal"><span class="pre">data_class</span></tt> option on your form.</li>
</ol>
<p>If you <em>don&#8217;t</em> do either of these, then the form will return the data as
an array. In this example, since <tt class="docutils literal"><span class="pre">$defaultData</span></tt> is not an object (and
no <tt class="docutils literal"><span class="pre">data_class</span></tt> option is set), <tt class="docutils literal"><span class="pre">$form-&gt;getData()</span></tt> ultimately returns
an array.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>You can also access POST values (in this case &#8220;name&#8221;) directly through
the request object, like so:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p class="last">Be advised, however, that in most cases using the getData() method is
a better choice, since it returns the data (usually an object) after
it&#8217;s been transformed by the form framework.</p>
</div>
<div class="section" id="adding-validation">
<h3>Adding Validation<a class="headerlink" href="#adding-validation" title="Permalink to this headline">¶</a></h3>
<p>The only missing piece is validation. Usually, when you call <tt class="docutils literal"><span class="pre">$form-&gt;isValid()</span></tt>,
the object is validated by reading the constraints that you applied to that
class. But without a class, how can you add constraints to the data of your
form?</p>
<p>The answer is to setup the constraints yourself, and pass them into your
form. The overall approach is covered a bit more in the <a class="reference internal" href="validation.html#book-validation-raw-values"><em>validation chapter</em></a>,
but here&#8217;s a short example:</p>
<div class="highlight-python"><pre>// import the namespaces above your controller class
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\MinLength;
use Symfony\Component\Validator\Constraints\Collection;

$collectionConstraint = new Collection(array(
    'name' =&gt; new MinLength(5),
    'email' =&gt; new Email(array('message' =&gt; 'Invalid email address')),
));

// create a form, no default values, pass in the constraint option
$form = $this-&gt;createFormBuilder(null, array(
    'validation_constraint' =&gt; $collectionConstraint,
))-&gt;add('email', 'email')
    // ...
;</pre>
</div>
<p>Now, when you call <cite>$form-&gt;bind($request)</cite>, the constraints setup here are run
against your form&#8217;s data. If you&#8217;re using a form class, override the <tt class="docutils literal"><span class="pre">setDefaultOptions()</span></tt>
method to specify the option:</p>
<div class="highlight-python"><pre>namespace Acme\TaskBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\MinLength;
use Symfony\Component\Validator\Constraints\Collection;

class ContactType extends AbstractType
{
    // ...

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $collectionConstraint = new Collection(array(
            'name' =&gt; new MinLength(5),
            'email' =&gt; new Email(array('message' =&gt; 'Invalid email address')),
        ));

        $resolver-&gt;setDefaults(array(
            'validation_constraint' =&gt; $collectionConstraint
        ));
    }
}</pre>
</div>
<p>Now, you have the flexibility to create forms - with validation - that return
an array of data, instead of an object. In most cases, it&#8217;s better - and
certainly more robust - to bind your form to an object. But for simple forms,
this is a great approach.</p>
</div>
</div>
<div class="section" id="final-thoughts">
<h2>Final Thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h2>
<p>You now know all of the building blocks necessary to build complex and
functional forms for your application. When building forms, keep in mind that
the first goal of a form is to translate data from an object (<tt class="docutils literal"><span class="pre">Task</span></tt>) to an
HTML form so that the user can modify that data. The second goal of a form is to
take the data submitted by the user and to re-apply it to the object.</p>
<p>There&#8217;s still much more to learn about the powerful world of forms, such as
how to handle <a class="reference internal" href="../cookbook/doctrine/file_uploads.html"><em>file uploads with Doctrine</em></a> or how to create a form where a dynamic
number of sub-forms can be added (e.g. a todo list where you can keep adding
more fields via Javascript before submitting). See the cookbook for these
topics. Also, be sure to lean on the
<a class="reference internal" href="../reference/forms/types.html"><em>field type reference documentation</em></a>, which
includes examples of how to use each field type and its options.</p>
</div>
<div class="section" id="learn-more-from-the-cookbook">
<h2>Learn more from the Cookbook<a class="headerlink" href="#learn-more-from-the-cookbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../cookbook/doctrine/file_uploads.html"><em>How to handle File Uploads with Doctrine</em></a></li>
<li><a class="reference internal" href="../reference/forms/types/file.html"><em>File Field Reference</em></a></li>
<li><a class="reference internal" href="../cookbook/form/create_custom_field_type.html"><em>Creating Custom Field Types</em></a></li>
<li><a class="reference internal" href="../cookbook/form/form_customization.html"><em>How to customize Form Rendering</em></a></li>
<li><a class="reference internal" href="../cookbook/form/dynamic_form_generation.html"><em>How to Dynamically Generate Forms Using Form Events</em></a></li>
<li><a class="reference internal" href="../cookbook/form/data_transformers.html"><em>How to use Data Transformers</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Forms</a><ul>
<li><a class="reference internal" href="#creating-a-simple-form">Creating a Simple Form</a><ul>
<li><a class="reference internal" href="#building-the-form">Building the Form</a></li>
<li><a class="reference internal" href="#rendering-the-form">Rendering the Form</a></li>
<li><a class="reference internal" href="#handling-form-submissions">Handling Form Submissions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#form-validation">Form Validation</a><ul>
<li><a class="reference internal" href="#validation-groups">Validation Groups</a></li>
<li><a class="reference internal" href="#groups-based-on-submitted-data">Groups based on Submitted Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#built-in-field-types">Built-in Field Types</a><ul>
<li><a class="reference internal" href="#text-fields">Text Fields</a></li>
<li><a class="reference internal" href="#choice-fields">Choice Fields</a></li>
<li><a class="reference internal" href="#date-and-time-fields">Date and Time Fields</a></li>
<li><a class="reference internal" href="#other-fields">Other Fields</a></li>
<li><a class="reference internal" href="#field-groups">Field Groups</a></li>
<li><a class="reference internal" href="#hidden-fields">Hidden Fields</a></li>
<li><a class="reference internal" href="#base-fields">Base Fields</a></li>
<li><a class="reference internal" href="#field-type-options">Field Type Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-type-guessing">Field Type Guessing</a><ul>
<li><a class="reference internal" href="#field-type-options-guessing">Field Type Options Guessing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rendering-a-form-in-a-template">Rendering a Form in a Template</a><ul>
<li><a class="reference internal" href="#rendering-each-field-by-hand">Rendering each Field by Hand</a></li>
<li><a class="reference internal" href="#twig-template-function-reference">Twig Template Function Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-form-classes">Creating Form Classes</a></li>
<li><a class="reference internal" href="#forms-and-doctrine">Forms and Doctrine</a></li>
<li><a class="reference internal" href="#embedded-forms">Embedded Forms</a><ul>
<li><a class="reference internal" href="#embedding-a-single-object">Embedding a Single Object</a></li>
<li><a class="reference internal" href="#embedding-a-collection-of-forms">Embedding a Collection of Forms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#form-theming">Form Theming</a><ul>
<li><a class="reference internal" href="#form-fragment-naming">Form Fragment Naming</a></li>
<li><a class="reference internal" href="#template-fragment-inheritance">Template Fragment Inheritance</a></li>
<li><a class="reference internal" href="#global-form-theming">Global Form Theming</a><ul>
<li><a class="reference internal" href="#twig">Twig</a></li>
<li><a class="reference internal" href="#php">PHP</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#csrf-protection">CSRF Protection</a></li>
<li><a class="reference internal" href="#using-a-form-without-a-class">Using a Form without a Class</a><ul>
<li><a class="reference internal" href="#adding-validation">Adding Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#final-thoughts">Final Thoughts</a></li>
<li><a class="reference internal" href="#learn-more-from-the-cookbook">Learn more from the Cookbook</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="validation.html"
                        title="previous chapter">Validation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="security.html"
                        title="next chapter">Security</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/book/forms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="security.html" title="Security"
             >next</a> |</li>
        <li class="right" >
          <a href="validation.html" title="Validation"
             >previous</a> |</li>
        <li><a href="../index.html">Symfony2Docs v2.1.0 2.1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >The Book</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Symfony Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>