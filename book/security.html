

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Security &mdash; Symfony Docs 2.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Symfony Docs 2.3 documentation" href="../index.html" />
    <link rel="up" title="The Book" href="index.html" />
    <link rel="next" title="HTTP Cache" href="http_cache.html" />
    <link rel="prev" title="Forms" href="forms.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="http_cache.html" title="HTTP Cache"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="forms.html" title="Forms"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Symfony Docs 2.3 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">The Book</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="security">
<span id="index-0"></span><h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<p>Security is a two-step process whose goal is to prevent a user from accessing
a resource that he/she should not have access to.</p>
<p>In the first step of the process, the security system identifies who the user
is by requiring the user to submit some sort of identification. This is called
<strong>authentication</strong>, and it means that the system is trying to find out who
you are.</p>
<p>Once the system knows who you are, the next step is to determine if you should
have access to a given resource. This part of the process is called <strong>authorization</strong>,
and it means that the system is checking to see if you have privileges to
perform a certain action.</p>
<img alt="../_images/security_authentication_authorization.png" class="align-center" src="../_images/security_authentication_authorization.png" />
<p>Since the best way to learn is to see an example, start by securing your
application with HTTP Basic authentication.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://github.com/symfony/Security">Symfony&#8217;s security component</a> is available as a standalone PHP library
for use inside any PHP project.</p>
</div>
<div class="section" id="basic-example-http-authentication">
<h2>Basic Example: HTTP Authentication<a class="headerlink" href="#basic-example-http-authentication" title="Permalink to this headline">¶</a></h2>
<p>The security component can be configured via your application configuration.
In fact, most standard security setups are just a matter of using the right
configuration. The following configuration tells Symfony to secure any URL
matching <tt class="docutils literal"><span class="pre">/admin/*</span></tt> and to ask the user for credentials using basic HTTP
authentication (i.e. the old-school username/password box):</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">secured_area</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>    <span class="l-Scalar-Plain">^/</span>
            <span class="l-Scalar-Plain">anonymous</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
            <span class="l-Scalar-Plain">http_basic</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">realm</span><span class="p-Indicator">:</span> <span class="s">&quot;Secured</span><span class="nv"> </span><span class="s">Demo</span><span class="nv"> </span><span class="s">Area&quot;</span>

    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_ADMIN</span> <span class="p-Indicator">}</span>

    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">in_memory</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">memory</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">ryan</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">ryanpass</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_USER&#39;</span> <span class="p-Indicator">}</span>
                    <span class="l-Scalar-Plain">admin</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">kitten</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_ADMIN&#39;</span> <span class="p-Indicator">}</span>

    <span class="l-Scalar-Plain">encoders</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">Symfony\Component\Security\Core\User\User</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">plaintext</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="nt">&lt;srv:container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/security&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:srv=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- app/config/security.xml --&gt;</span>

    <span class="nt">&lt;config&gt;</span>
        <span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;secured_area&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;anonymous</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;http-basic</span> <span class="na">realm=</span><span class="s">&quot;Secured Demo Area&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/firewall&gt;</span>

        <span class="nt">&lt;access-control&gt;</span>
            <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/access-control&gt;</span>

        <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;in_memory&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;memory&gt;</span>
                <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;ryan&quot;</span> <span class="na">password=</span><span class="s">&quot;ryanpass&quot;</span> <span class="na">roles=</span><span class="s">&quot;ROLE_USER&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;admin&quot;</span> <span class="na">password=</span><span class="s">&quot;kitten&quot;</span> <span class="na">roles=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/memory&gt;</span>
        <span class="nt">&lt;/provider&gt;</span>

        <span class="nt">&lt;encoder</span> <span class="na">class=</span><span class="s">&quot;Symfony\Component\Security\Core\User\User&quot;</span>
            <span class="na">algorithm=</span><span class="s">&quot;plaintext&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/config&gt;</span>
<span class="nt">&lt;/srv:container&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;secured_area&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;pattern&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;^/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;anonymous&#39;</span>  <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
            <span class="s1">&#39;http_basic&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;realm&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Secured Demo Area&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;in_memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;users&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">&#39;ryan&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ryanpass&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span>
                        <span class="p">),</span>
                    <span class="s1">&#39;admin&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;kitten&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="s1">&#39;encoders&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Symfony\Component\Security\Core\User\User&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;plaintext&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A standard Symfony distribution separates the security configuration
into a separate file (e.g. <tt class="docutils literal"><span class="pre">app/config/security.yml</span></tt>). If you don&#8217;t
have a separate security file, you can put the configuration directly
into your main config file (e.g. <tt class="docutils literal"><span class="pre">app/config/config.yml</span></tt>).</p>
</div>
<p>The end result of this configuration is a fully-functional security system
that looks like the following:</p>
<ul class="simple">
<li>There are two users in the system (<tt class="docutils literal"><span class="pre">ryan</span></tt> and <tt class="docutils literal"><span class="pre">admin</span></tt>);</li>
<li>Users authenticate themselves via the basic HTTP authentication prompt;</li>
<li>Any URL matching <tt class="docutils literal"><span class="pre">/admin/*</span></tt> is secured, and only the <tt class="docutils literal"><span class="pre">admin</span></tt> user
can access it;</li>
<li>All URLs <em>not</em> matching <tt class="docutils literal"><span class="pre">/admin/*</span></tt> are accessible by all users (and the
user is never prompted to login).</li>
</ul>
<p>Let&#8217;s look briefly at how security works and how each part of the configuration
comes into play.</p>
</div>
<div class="section" id="how-security-works-authentication-and-authorization">
<h2>How Security Works: Authentication and Authorization<a class="headerlink" href="#how-security-works-authentication-and-authorization" title="Permalink to this headline">¶</a></h2>
<p>Symfony&#8217;s security system works by determining who a user is (i.e. authentication)
and then checking to see if that user should have access to a specific resource
or URL.</p>
<div class="section" id="firewalls-authentication">
<span id="book-security-firewalls"></span><h3>Firewalls (Authentication)<a class="headerlink" href="#firewalls-authentication" title="Permalink to this headline">¶</a></h3>
<p>When a user makes a request to a URL that&#8217;s protected by a firewall, the
security system is activated. The job of the firewall is to determine whether
or not the user needs to be authenticated, and if he does, to send a response
back to the user initiating the authentication process.</p>
<p>A firewall is activated when the URL of an incoming request matches the configured
firewall&#8217;s regular expression <tt class="docutils literal"><span class="pre">pattern</span></tt> config value. In this example, the
<tt class="docutils literal"><span class="pre">pattern</span></tt> (<tt class="docutils literal"><span class="pre">^/</span></tt>) will match <em>every</em> incoming request. The fact that the
firewall is activated does <em>not</em> mean, however, that the HTTP authentication
username and password box is displayed for every URL. For example, any user
can access <tt class="docutils literal"><span class="pre">/foo</span></tt> without being prompted to authenticate.</p>
<img alt="../_images/security_anonymous_user_access.png" class="align-center" src="../_images/security_anonymous_user_access.png" />
<p>This works first because the firewall allows <em>anonymous users</em> via the <tt class="docutils literal"><span class="pre">anonymous</span></tt>
configuration parameter. In other words, the firewall doesn&#8217;t require the
user to fully authenticate immediately. And because no special <tt class="docutils literal"><span class="pre">role</span></tt> is
needed to access <tt class="docutils literal"><span class="pre">/foo</span></tt> (under the <tt class="docutils literal"><span class="pre">access_control</span></tt> section), the request
can be fulfilled without ever asking the user to authenticate.</p>
<p>If you remove the <tt class="docutils literal"><span class="pre">anonymous</span></tt> key, the firewall will <em>always</em> make a user
fully authenticate immediately.</p>
</div>
<div class="section" id="access-controls-authorization">
<h3>Access Controls (Authorization)<a class="headerlink" href="#access-controls-authorization" title="Permalink to this headline">¶</a></h3>
<p>If a user requests <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>, however, the process behaves differently.
This is because of the <tt class="docutils literal"><span class="pre">access_control</span></tt> configuration section that says
that any URL matching the regular expression pattern <tt class="docutils literal"><span class="pre">^/admin</span></tt> (i.e. <tt class="docutils literal"><span class="pre">/admin</span></tt>
or anything matching <tt class="docutils literal"><span class="pre">/admin/*</span></tt>) requires the <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role. Roles
are the basis for most authorization: a user can access <tt class="docutils literal"><span class="pre">/admin/foo</span></tt> only
if it has the <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role.</p>
<img alt="../_images/security_anonymous_user_denied_authorization.png" class="align-center" src="../_images/security_anonymous_user_denied_authorization.png" />
<p>Like before, when the user originally makes the request, the firewall doesn&#8217;t
ask for any identification. However, as soon as the access control layer
denies the user access (because the anonymous user doesn&#8217;t have the <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt>
role), the firewall jumps into action and initiates the authentication process.
The authentication process depends on the authentication mechanism you&#8217;re
using. For example, if you&#8217;re using the form login authentication method,
the user will be redirected to the login page. If you&#8217;re using HTTP authentication,
the user will be sent an HTTP 401 response so that the user sees the username
and password box.</p>
<p>The user now has the opportunity to submit its credentials back to the application.
If the credentials are valid, the original request can be re-tried.</p>
<img alt="../_images/security_ryan_no_role_admin_access.png" class="align-center" src="../_images/security_ryan_no_role_admin_access.png" />
<p>In this example, the user <tt class="docutils literal"><span class="pre">ryan</span></tt> successfully authenticates with the firewall.
But since <tt class="docutils literal"><span class="pre">ryan</span></tt> doesn&#8217;t have the <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role, he&#8217;s still denied
access to <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>. Ultimately, this means that the user will see some
sort of message indicating that access has been denied.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When Symfony denies the user access, the user sees an error screen and
receives a 403 HTTP status code (<tt class="docutils literal"><span class="pre">Forbidden</span></tt>). You can customize the
access denied error screen by following the directions in the
<a class="reference internal" href="../cookbook/controller/error_pages.html#cookbook-error-pages-by-status-code"><em>Error Pages</em></a> cookbook entry
to customize the 403 error page.</p>
</div>
<p>Finally, if the <tt class="docutils literal"><span class="pre">admin</span></tt> user requests <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>, a similar process
takes place, except now, after being authenticated, the access control layer
will let the request pass through:</p>
<img alt="../_images/security_admin_role_access.png" class="align-center" src="../_images/security_admin_role_access.png" />
<p>The request flow when a user requests a protected resource is straightforward,
but incredibly flexible. As you&#8217;ll see later, authentication can be handled
in any number of ways, including via a form login, X.509 certificate, or by
authenticating the user via Twitter. Regardless of the authentication method,
the request flow is always the same:</p>
<ol class="arabic simple">
<li>A user accesses a protected resource;</li>
<li>The application redirects the user to the login form;</li>
<li>The user submits its credentials (e.g. username/password);</li>
<li>The firewall authenticates the user;</li>
<li>The authenticated user re-tries the original request.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <em>exact</em> process actually depends a little bit on which authentication
mechanism you&#8217;re using. For example, when using form login, the user
submits its credentials to one URL that processes the form (e.g. <tt class="docutils literal"><span class="pre">/login_check</span></tt>)
and then is redirected back to the originally requested URL (e.g. <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>).
But with HTTP authentication, the user submits its credentials directly
to the original URL (e.g. <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>) and then the page is returned
to the user in that same request (i.e. no redirect).</p>
<p class="last">These types of idiosyncrasies shouldn&#8217;t cause you any problems, but they&#8217;re
good to keep in mind.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You&#8217;ll also learn later how <em>anything</em> can be secured in Symfony2, including
specific controllers, objects, or even PHP methods.</p>
</div>
</div>
</div>
<div class="section" id="using-a-traditional-login-form">
<span id="book-security-form-login"></span><h2>Using a Traditional Login Form<a class="headerlink" href="#using-a-traditional-login-form" title="Permalink to this headline">¶</a></h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In this section, you&#8217;ll learn how to create a basic login form that continues
to use the hard-coded users that are defined in the <tt class="docutils literal"><span class="pre">security.yml</span></tt> file.</p>
<p class="last">To load users from the database, please read <a class="reference internal" href="../cookbook/security/entity_provider.html"><em>How to load Security Users from the Database (the Entity Provider)</em></a>.
By reading that article and this section, you can create a full login form
system that loads users from the database.</p>
</div>
<p>So far, you&#8217;ve seen how to blanket your application beneath a firewall and
then protect access to certain areas with roles. By using HTTP Authentication,
you can effortlessly tap into the native username/password box offered by
all browsers. However, Symfony supports many authentication mechanisms out
of the box. For details on all of them, see the
<a class="reference internal" href="../reference/configuration/security.html"><em>Security Configuration Reference</em></a>.</p>
<p>In this section, you&#8217;ll enhance this process by allowing the user to authenticate
via a traditional HTML login form.</p>
<p>First, enable form login under your firewall:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">secured_area</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>    <span class="l-Scalar-Plain">^/</span>
            <span class="l-Scalar-Plain">anonymous</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
            <span class="l-Scalar-Plain">form_login</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">login_path</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">login</span>
                <span class="l-Scalar-Plain">check_path</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">login_check</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="nt">&lt;srv:container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/security&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:srv=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- app/config/security.xml --&gt;</span>

    <span class="nt">&lt;config&gt;</span>
        <span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;secured_area&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;anonymous</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;form-login</span> <span class="na">login_path=</span><span class="s">&quot;login&quot;</span> <span class="na">check_path=</span><span class="s">&quot;login_check&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/firewall&gt;</span>
    <span class="nt">&lt;/config&gt;</span>
<span class="nt">&lt;/srv:container&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;secured_area&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;pattern&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;^/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;anonymous&#39;</span>  <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
            <span class="s1">&#39;form_login&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;login_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span>
                <span class="s1">&#39;check_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login_check&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>If you don&#8217;t need to customize your <tt class="docutils literal"><span class="pre">login_path</span></tt> or <tt class="docutils literal"><span class="pre">check_path</span></tt>
values (the values used here are the default values), you can shorten
your configuration:</p>
<div class="last configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">form_login</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;form-login</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;form_login&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<p>Now, when the security system initiates the authentication process, it will
redirect the user to the login form (<tt class="docutils literal"><span class="pre">/login</span></tt> by default). Implementing this
login form visually is your job. First, create the two routes you used in the
security configuration: the <tt class="docutils literal"><span class="pre">login</span></tt> route will display the login form (i.e.
<tt class="docutils literal"><span class="pre">/login</span></tt>) and the <tt class="docutils literal"><span class="pre">login_check</span></tt> route will handle the login form
submission (i.e.  <tt class="docutils literal"><span class="pre">/login_check</span></tt>):</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/routing.yml</span>
<span class="l-Scalar-Plain">login</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/login</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeSecurityBundle</span><span class="p-Indicator">:</span><span class="nv">Security</span><span class="p-Indicator">:</span><span class="nv">login</span> <span class="p-Indicator">}</span>
<span class="l-Scalar-Plain">login_check</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/login_check</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing</span>
<span class="s">        http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;login&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/login&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeSecurityBundle:Security:login<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;login_check&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/login_check&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/routing.php</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Routing\RouteCollection</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Routing\Route</span><span class="p">;</span>

<span class="nv">$collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RouteCollection</span><span class="p">();</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;_controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AcmeDemoBundle:Security:login&#39;</span><span class="p">,</span>
<span class="p">)));</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;login_check&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Route</span><span class="p">(</span><span class="s1">&#39;/login_check&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">()));</span>

<span class="k">return</span> <span class="nv">$collection</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will <em>not</em> need to implement a controller for the <tt class="docutils literal"><span class="pre">/login_check</span></tt>
URL as the firewall will automatically catch and process any form submitted
to this URL.</p>
</div>
<p class="versionadded">
<span class="versionmodified">New in version 2.1: </span>As of Symfony 2.1, you <em>must</em> have routes configured for your <tt class="docutils literal"><span class="pre">login_path</span></tt>,
<tt class="docutils literal"><span class="pre">check_path</span></tt> <tt class="docutils literal"><span class="pre">logout</span></tt> keys. These keys can be route names (as shown
in this example) or URLs that have routes configured for them.</p>
<p>Notice that the name of the <tt class="docutils literal"><span class="pre">login</span></tt> route matches the <tt class="docutils literal"><span class="pre">login_path</span></tt> config
value, as that&#8217;s where the security system will redirect users that need
to login.</p>
<p>Next, create the controller that will display the login form:</p>
<div class="highlight-python"><pre>// src/Acme/SecurityBundle/Controller/SecurityController.php;
namespace Acme\SecurityBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\Security\Core\SecurityContext;

class SecurityController extends Controller
{
    public function loginAction()
    {
        $request = $this-&gt;getRequest();
        $session = $request-&gt;getSession();

        // get the login error if there is one
        if ($request-&gt;attributes-&gt;has(SecurityContext::AUTHENTICATION_ERROR)) {
            $error = $request-&gt;attributes-&gt;get(
                SecurityContext::AUTHENTICATION_ERROR
            );
        } else {
            $error = $session-&gt;get(SecurityContext::AUTHENTICATION_ERROR);
            $session-&gt;remove(SecurityContext::AUTHENTICATION_ERROR);
        }

        return $this-&gt;render(
            'AcmeSecurityBundle:Security:login.html.twig',
            array(
                // last username entered by the user
                'last_username' =&gt; $session-&gt;get(SecurityContext::LAST_USERNAME),
                'error'         =&gt; $error,
            )
        );
    }
}</pre>
</div>
<p>Don&#8217;t let this controller confuse you. As you&#8217;ll see in a moment, when the
user submits the form, the security system automatically handles the form
submission for you. If the user had submitted an invalid username or password,
this controller reads the form submission error from the security system so
that it can be displayed back to the user.</p>
<p>In other words, your job is to display the login form and any login errors
that may have occurred, but the security system itself takes care of checking
the submitted username and password and authenticating the user.</p>
<p>Finally, create the corresponding template:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/SecurityBundle/Resources/views/Security/login.html.twig #}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">error</span> <span class="cp">%}</span>
    <span class="nt">&lt;div&gt;</span><span class="cp">{{</span> <span class="nv">error.message</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;login_check&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;username&quot;</span><span class="nt">&gt;</span>Username:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;username&quot;</span> <span class="na">name=</span><span class="s">&quot;_username&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">last_username</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;password&quot;</span><span class="nt">&gt;</span>Password:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">id=</span><span class="s">&quot;password&quot;</span> <span class="na">name=</span><span class="s">&quot;_password&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">{#</span>
<span class="c">        If you want to control the URL the user</span>
<span class="c">        is redirected to on success (more details below)</span>
<span class="c">        &lt;input type=&quot;hidden&quot; name=&quot;_target_path&quot; value=&quot;/account&quot; /&gt;</span>
<span class="c">    #}</span>

    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>login<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- src/Acme/SecurityBundle/Resources/views/Security/login.html.php --&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$error</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;div&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$error</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;login_check&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;username&quot;</span><span class="nt">&gt;</span>Username:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;username&quot;</span> <span class="na">name=</span><span class="s">&quot;_username&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$last_username</span> <span class="cp">?&gt;</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;password&quot;</span><span class="nt">&gt;</span>Password:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">id=</span><span class="s">&quot;password&quot;</span> <span class="na">name=</span><span class="s">&quot;_password&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!--</span>
<span class="c">        If you want to control the URL the user</span>
<span class="c">        is redirected to on success (more details below)</span>
<span class="c">        &lt;input type=&quot;hidden&quot; name=&quot;_target_path&quot; value=&quot;/account&quot; /&gt;</span>
<span class="c">    --&gt;</span>

    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>login<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The <tt class="docutils literal"><span class="pre">error</span></tt> variable passed into the template is an instance of
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Exception/AuthenticationException.html" title="Symfony\Component\Security\Core\Exception\AuthenticationException"><span class="pre">AuthenticationException</span></a></tt>.
It may contain more information - or even sensitive information - about
the authentication failure, so use it wisely!</p>
</div>
<p>The form has very few requirements. First, by submitting the form to <tt class="docutils literal"><span class="pre">/login_check</span></tt>
(via the <tt class="docutils literal"><span class="pre">login_check</span></tt> route), the security system will intercept the form
submission and process the form for you automatically. Second, the security
system expects the submitted fields to be called <tt class="docutils literal"><span class="pre">_username</span></tt> and <tt class="docutils literal"><span class="pre">_password</span></tt>
(these field names can be <a class="reference internal" href="../reference/configuration/security.html#reference-security-firewall-form-login"><em>configured</em></a>).</p>
<p>And that&#8217;s it! When you submit the form, the security system will automatically
check the user&#8217;s credentials and either authenticate the user or send the
user back to the login form where the error can be displayed.</p>
<p>Let&#8217;s review the whole process:</p>
<ol class="arabic simple">
<li>The user tries to access a resource that is protected;</li>
<li>The firewall initiates the authentication process by redirecting the
user to the login form (<tt class="docutils literal"><span class="pre">/login</span></tt>);</li>
<li>The <tt class="docutils literal"><span class="pre">/login</span></tt> page renders login form via the route and controller created
in this example;</li>
<li>The user submits the login form to <tt class="docutils literal"><span class="pre">/login_check</span></tt>;</li>
<li>The security system intercepts the request, checks the user&#8217;s submitted
credentials, authenticates the user if they are correct, and sends the
user back to the login form if they are not.</li>
</ol>
<p>By default, if the submitted credentials are correct, the user will be redirected
to the original page that was requested (e.g. <tt class="docutils literal"><span class="pre">/admin/foo</span></tt>). If the user
originally went straight to the login page, he&#8217;ll be redirected to the homepage.
This can be highly customized, allowing you to, for example, redirect the
user to a specific URL.</p>
<p>For more details on this and how to customize the form login process in general,
see <a class="reference internal" href="../cookbook/security/form_login.html"><em>How to customize your Form Login</em></a>.</p>
<div class="sidebar" id="book-security-common-pitfalls">
<p class="first sidebar-title">Avoid Common Pitfalls</p>
<p>When setting up your login form, watch out for a few common pitfalls.</p>
<p><strong>1. Create the correct routes</strong></p>
<p>First, be sure that you&#8217;ve defined the <tt class="docutils literal"><span class="pre">login</span></tt> and <tt class="docutils literal"><span class="pre">login_check</span></tt>
routes correctly and that they correspond to the <tt class="docutils literal"><span class="pre">login_path</span></tt> and
<tt class="docutils literal"><span class="pre">check_path</span></tt> config values. A misconfiguration here can mean that you&#8217;re
redirected to a 404 page instead of the login page, or that submitting
the login form does nothing (you just see the login form over and over
again).</p>
<p><strong>2. Be sure the login page isn&#8217;t secure</strong></p>
<p>Also, be sure that the login page does <em>not</em> require any roles to be
viewed. For example, the following configuration - which requires the
<tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role for all URLs (including the <tt class="docutils literal"><span class="pre">/login</span></tt> URL), will
cause a redirect loop:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_ADMIN</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;access-control&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/access-control&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Removing the access control on the <tt class="docutils literal"><span class="pre">/login</span></tt> URL fixes the problem:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/login</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">IS_AUTHENTICATED_ANONYMOUSLY</span> <span class="p-Indicator">}</span>
    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_ADMIN</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;access-control&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/login&quot;</span> <span class="na">role=</span><span class="s">&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/access-control&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/login&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;IS_AUTHENTICATED_ANONYMOUSLY&#39;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Also, if your firewall does <em>not</em> allow for anonymous users, you&#8217;ll need
to create a special firewall that allows anonymous users for the login
page:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">login_firewall</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>    <span class="l-Scalar-Plain">^/login$</span>
        <span class="l-Scalar-Plain">anonymous</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">~</span>
    <span class="l-Scalar-Plain">secured_area</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>    <span class="l-Scalar-Plain">^/</span>
        <span class="l-Scalar-Plain">form_login</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;login_firewall&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/login$&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;anonymous</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/firewall&gt;</span>
<span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;secured_area&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form_login</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/firewall&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;login_firewall&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;pattern&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;^/login$&#39;</span><span class="p">,</span>
        <span class="s1">&#39;anonymous&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
    <span class="p">),</span>
    <span class="s1">&#39;secured_area&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;pattern&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;^/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;form_login&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
    <span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p><strong>3. Be sure ``/login_check`` is behind a firewall</strong></p>
<p>Next, make sure that your <tt class="docutils literal"><span class="pre">check_path</span></tt> URL (e.g. <tt class="docutils literal"><span class="pre">/login_check</span></tt>)
is behind the firewall you&#8217;re using for your form login (in this example,
the single firewall matches <em>all</em> URLs, including <tt class="docutils literal"><span class="pre">/login_check</span></tt>). If
<tt class="docutils literal"><span class="pre">/login_check</span></tt> doesn&#8217;t match any firewall, you&#8217;ll receive a <tt class="docutils literal"><span class="pre">Unable</span>
<span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">controller</span> <span class="pre">for</span> <span class="pre">path</span> <span class="pre">&quot;/login_check&quot;</span></tt> exception.</p>
<p><strong>4. Multiple firewalls don&#8217;t share security context</strong></p>
<p class="last">If you&#8217;re using multiple firewalls and you authenticate against one firewall,
you will <em>not</em> be authenticated against any other firewalls automatically.
Different firewalls are like different security systems. To do this you have
to explicitly specify the same <a class="reference internal" href="../reference/configuration/security.html#reference-security-firewall-context"><em>Firewall Context</em></a>
for different firewalls. But usually for most applications, having one
main firewall is enough.</p>
</div>
</div>
<div class="section" id="authorization">
<h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<p>The first step in security is always authentication: the process of verifying
who the user is. With Symfony, authentication can be done in any way - via
a form login, basic HTTP Authentication, or even via Facebook.</p>
<p>Once the user has been authenticated, authorization begins. Authorization
provides a standard and powerful way to decide if a user can access any resource
(a URL, a model object, a method call, ...). This works by assigning specific
roles to each user, and then requiring different roles for different resources.</p>
<p>The process of authorization has two different sides:</p>
<ol class="arabic simple">
<li>The user has a specific set of roles;</li>
<li>A resource requires a specific role in order to be accessed.</li>
</ol>
<p>In this section, you&#8217;ll focus on how to secure different resources (e.g. URLs,
method calls, etc) with different roles. Later, you&#8217;ll learn more about how
roles are created and assigned to users.</p>
<div class="section" id="securing-specific-url-patterns">
<h3>Securing Specific URL Patterns<a class="headerlink" href="#securing-specific-url-patterns" title="Permalink to this headline">¶</a></h3>
<p>The most basic way to secure part of your application is to secure an entire
URL pattern. You&#8217;ve seen this already in the first example of this chapter,
where anything matching the regular expression pattern <tt class="docutils literal"><span class="pre">^/admin</span></tt> requires
the <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">Understanding exactly how <tt class="docutils literal"><span class="pre">access_control</span></tt> works is <strong>very</strong> important
to make sure your application is properly secured. See <a class="reference internal" href="#security-book-access-control-explanation"><em>Understanding how access_control works</em></a>
below for detailed information.</p>
</div>
<p>You can define as many URL patterns as you need - each is a regular expression.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin/users</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_SUPER_ADMIN</span> <span class="p-Indicator">}</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_ADMIN</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin/users&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_SUPER_ADMIN&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin/users&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_SUPER_ADMIN&#39;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span> <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Prepending the path with <tt class="docutils literal"><span class="pre">^</span></tt> ensures that only URLs <em>beginning</em> with
the pattern are matched. For example, a path of simply <tt class="docutils literal"><span class="pre">/admin</span></tt> (without
the <tt class="docutils literal"><span class="pre">^</span></tt>) would correctly match <tt class="docutils literal"><span class="pre">/admin/foo</span></tt> but would also match URLs
like <tt class="docutils literal"><span class="pre">/foo/admin</span></tt>.</p>
</div>
</div>
<div class="section" id="understanding-how-access-control-works">
<span id="security-book-access-control-explanation"></span><h3>Understanding how <tt class="docutils literal"><span class="pre">access_control</span></tt> works<a class="headerlink" href="#understanding-how-access-control-works" title="Permalink to this headline">¶</a></h3>
<p>For each incoming request, Symfony2 checks each <tt class="docutils literal"><span class="pre">access_control</span></tt> entry
to find <em>one</em> that matches the current request. As soon as it finds a matching
<tt class="docutils literal"><span class="pre">access_control</span></tt> entry, it stops - only the <strong>first</strong> matching <tt class="docutils literal"><span class="pre">access_control</span></tt>
is used to enforce access.</p>
<p>Each <tt class="docutils literal"><span class="pre">access_control</span></tt> has several options that configure two different
things: (a) <a class="reference internal" href="#security-book-access-control-matching-options"><em>should the incoming request match this access control entry</em></a>
and (b) <a class="reference internal" href="#security-book-access-control-enforcement-options"><em>once it matches, should some sort of access restriction be enforced</em></a>:</p>
<p id="security-book-access-control-matching-options"><strong>(a) Matching Options</strong></p>
<p>Symfony2 creates an instance of <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/RequestMatcher.html" title="Symfony\Component\HttpFoundation\RequestMatcher"><span class="pre">RequestMatcher</span></a></tt>
for each <tt class="docutils literal"><span class="pre">access_control</span></tt> entry, which determines whether or not a given
access control should be used on this request. The following <tt class="docutils literal"><span class="pre">access_control</span></tt>
options are used for matching:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">path</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ip</span></tt> or <tt class="docutils literal"><span class="pre">ips</span></tt></li>
<li><tt class="docutils literal"><span class="pre">host</span></tt></li>
<li><tt class="docutils literal"><span class="pre">methods</span></tt></li>
</ul>
<p>Take the following <tt class="docutils literal"><span class="pre">access_control</span></tt> entries as an example:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_USER_IP</span><span class="p-Indicator">,</span> <span class="nv">ip</span><span class="p-Indicator">:</span> <span class="nv">127.0.0.1</span> <span class="p-Indicator">}</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_USER_HOST</span><span class="p-Indicator">,</span> <span class="nv">host</span><span class="p-Indicator">:</span> <span class="nv">symfony.com</span> <span class="p-Indicator">}</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_USER_METHOD</span><span class="p-Indicator">,</span> <span class="nv">methods</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">POST</span><span class="p-Indicator">,</span> <span class="nv">PUT</span><span class="p-Indicator">]</span> <span class="p-Indicator">}</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/admin</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_USER</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;access-control&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_USER_IP&quot;</span> <span class="na">ip=</span><span class="s">&quot;127.0.0.1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_USER_HOST&quot;</span> <span class="na">host=</span><span class="s">&quot;symfony.com&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_USER_METHOD&quot;</span> <span class="na">method=</span><span class="s">&quot;POST, PUT&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/admin&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_USER&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/access-control&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER_IP&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ip&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER_HOST&#39;</span><span class="p">,</span>
        <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;symfony.com&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER_METHOD&#39;</span><span class="p">,</span>
        <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;POST, PUT&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/admin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>For each incoming request, Symfony will decide which <tt class="docutils literal"><span class="pre">access_control</span></tt>
to use based on the URI, the client&#8217;s IP address, the incoming host name,
and the request method. Remember, the first rule that matches is used, and
if <tt class="docutils literal"><span class="pre">ip</span></tt>, <tt class="docutils literal"><span class="pre">host</span></tt> or <tt class="docutils literal"><span class="pre">method</span></tt> are not specified for an entry, that <tt class="docutils literal"><span class="pre">access_control</span></tt>
will match any <tt class="docutils literal"><span class="pre">ip</span></tt>, <tt class="docutils literal"><span class="pre">host</span></tt> or <tt class="docutils literal"><span class="pre">method</span></tt>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="22%" />
<col width="41%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>URI</strong></td>
<td><strong>IP</strong></td>
<td><strong>HOST</strong></td>
<td><strong>METHOD</strong></td>
<td><tt class="docutils literal"><span class="pre">access_control</span></tt></td>
<td>Why?</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>127.0.0.1</td>
<td>example.com</td>
<td>GET</td>
<td>rule #1 (<tt class="docutils literal"><span class="pre">ROLE_USER_IP</span></tt>)</td>
<td>The URI matches <tt class="docutils literal"><span class="pre">path</span></tt> and the IP matches <tt class="docutils literal"><span class="pre">ip</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>127.0.0.1</td>
<td>symfony.com</td>
<td>GET</td>
<td>rule #1 (<tt class="docutils literal"><span class="pre">ROLE_USER_IP</span></tt>)</td>
<td>The <tt class="docutils literal"><span class="pre">path</span></tt> and <tt class="docutils literal"><span class="pre">ip</span></tt> still match. This would also match
the <tt class="docutils literal"><span class="pre">ROLE_USER_HOST</span></tt> entry, but <em>only</em> the <strong>first</strong>
<tt class="docutils literal"><span class="pre">access_control</span></tt> match is used.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>168.0.0.1</td>
<td>symfony.com</td>
<td>GET</td>
<td>rule #2 (<tt class="docutils literal"><span class="pre">ROLE_USER_HOST</span></tt>)</td>
<td>The <tt class="docutils literal"><span class="pre">ip</span></tt> doesn&#8217;t match the first rule, so the second
rule (which matches) is used.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>168.0.0.1</td>
<td>symfony.com</td>
<td>POST</td>
<td>rule #2 (<tt class="docutils literal"><span class="pre">ROLE_USER_HOST</span></tt>)</td>
<td>The second rule still matches. This would also match the
third rule (<tt class="docutils literal"><span class="pre">ROLE_USER_METHOD</span></tt>), but only the <strong>first</strong>
matched <tt class="docutils literal"><span class="pre">access_control</span></tt> is used.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>168.0.0.1</td>
<td>example.com</td>
<td>POST</td>
<td>rule #3 (<tt class="docutils literal"><span class="pre">ROLE_USER_METHOD</span></tt>)</td>
<td>The <tt class="docutils literal"><span class="pre">ip</span></tt> and <tt class="docutils literal"><span class="pre">host</span></tt> don&#8217;t match the first two entries,
but the third - <tt class="docutils literal"><span class="pre">ROLE_USER_METHOD</span></tt> - matches and is used.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/admin/user</span></tt></td>
<td>168.0.0.1</td>
<td>example.com</td>
<td>GET</td>
<td>rule #4 (<tt class="docutils literal"><span class="pre">ROLE_USER</span></tt>)</td>
<td>The <tt class="docutils literal"><span class="pre">ip</span></tt>, <tt class="docutils literal"><span class="pre">host</span></tt> and <tt class="docutils literal"><span class="pre">method</span></tt> prevent the first
three entries from matching. But since the URI matches the
<tt class="docutils literal"><span class="pre">path</span></tt> pattern of the <tt class="docutils literal"><span class="pre">ROLE_USER</span></tt> entry, it is used.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">/foo</span></tt></td>
<td>127.0.0.1</td>
<td>symfony.com</td>
<td>POST</td>
<td>matches no entries</td>
<td>This doesn&#8217;t match any <tt class="docutils literal"><span class="pre">access_control</span></tt> rules, since its
URI doesn&#8217;t match any of the <tt class="docutils literal"><span class="pre">path</span></tt> values.</td>
</tr>
</tbody>
</table>
<p id="security-book-access-control-enforcement-options"><strong>(b) Access Enforcement</strong></p>
<p>Once Symfony2 has decided which <tt class="docutils literal"><span class="pre">access_control</span></tt> entry matches (if any),
it then <em>enforces</em> access restrictions based on the <tt class="docutils literal"><span class="pre">roles</span></tt> and <tt class="docutils literal"><span class="pre">requires_channel</span></tt>
options:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">role</span></tt> If the user does not have the given role(s), then access is denied
(internally, an <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Exception/AccessDeniedException.html" title="Symfony\Component\Security\Core\Exception\AccessDeniedException"><span class="pre">AccessDeniedException</span></a></tt>
is thrown);</li>
<li><tt class="docutils literal"><span class="pre">requires_channel</span></tt> If the incoming request&#8217;s channel (e.g. <tt class="docutils literal"><span class="pre">http</span></tt>)
does not match this value (e.g. <tt class="docutils literal"><span class="pre">https</span></tt>), the user will be redirected
(e.g. redirected from <tt class="docutils literal"><span class="pre">http</span></tt> to <tt class="docutils literal"><span class="pre">https</span></tt>, or vice versa).</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If access is denied, the system will try to authenticate the user if not
already (e.g. redirect the user to the login page). If the user is already
logged in, the 403 &#8220;access denied&#8221; error page will be shown. See
<a class="reference internal" href="../cookbook/controller/error_pages.html"><em>How to customize Error Pages</em></a> for more information.</p>
</div>
</div>
<div class="section" id="securing-by-ip">
<span id="book-security-securing-ip"></span><h3>Securing by IP<a class="headerlink" href="#securing-by-ip" title="Permalink to this headline">¶</a></h3>
<p>Certain situations may arise when you may need to restrict access to a given
path based on IP. This is particularly relevant in the case of
<a class="reference internal" href="http_cache.html#edge-side-includes"><em>Edge Side Includes</em></a> (ESI), for example. When ESI is
enabled, it&#8217;s recommended to secure access to ESI URLs. Indeed, some ESI may
contain some private content like the current logged in user&#8217;s information. To
prevent any direct access to these resources from a web browser (by guessing the
ESI URL pattern), the ESI route <strong>must</strong> be secured to be only visible from
the trusted reverse proxy cache.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.3: </span>Version 2.3 allows multiple IP addresses in a single rule with the <tt class="docutils literal"><span class="pre">ips:</span> <span class="pre">[a,</span> <span class="pre">b]</span></tt>
construct.  Prior to 2.3, users should create one rule per IP address to match and
use the <tt class="docutils literal"><span class="pre">ip</span></tt> key instead of <tt class="docutils literal"><span class="pre">ips</span></tt>.</p>
<p>Here is an example of how you might secure all ESI routes that start with a
given prefix, <tt class="docutils literal"><span class="pre">/esi</span></tt>, from outside access:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/esi</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">IS_AUTHENTICATED_ANONYMOUSLY</span><span class="p-Indicator">,</span> <span class="nv">ips</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">127.0.0.1</span><span class="p-Indicator">,</span> <span class="p-Indicator">::</span><span class="nv">1</span><span class="p-Indicator">]</span> <span class="p-Indicator">}</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/esi</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">ROLE_NO_ACCESS</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;access-control&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/esi&quot;</span> <span class="na">role=</span><span class="s">&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot;</span>
        <span class="na">ips=</span><span class="s">&quot;127.0.0.1, ::1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/esi&quot;</span> <span class="na">role=</span><span class="s">&quot;ROLE_NO_ACCESS&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/access-control&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/esi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;IS_AUTHENTICATED_ANONYMOUSLY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ips&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;127.0.0.1, ::1&#39;</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/esi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_NO_ACCESS&#39;</span>
    <span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Here is how it works when the path is <tt class="docutils literal"><span class="pre">/esi/something</span></tt> coming from the
<tt class="docutils literal"><span class="pre">10.0.0.1</span></tt> IP:</p>
<ul class="simple">
<li>The first access control rule is ignored as the <tt class="docutils literal"><span class="pre">path</span></tt> matches but the
<tt class="docutils literal"><span class="pre">ip</span></tt> does not match either of the IPs listed;</li>
<li>The second access control rule is enabled (the only restriction being the
<tt class="docutils literal"><span class="pre">path</span></tt> and it matches): as the user cannot have the <tt class="docutils literal"><span class="pre">ROLE_NO_ACCESS</span></tt>
role as it&#8217;s not defined, access is denied (the <tt class="docutils literal"><span class="pre">ROLE_NO_ACCESS</span></tt> role can
be anything that does not match an existing role, it just serves as a trick
to always deny access).</li>
</ul>
<p>Now, if the same request comes from <tt class="docutils literal"><span class="pre">127.0.0.1</span></tt> or <tt class="docutils literal"><span class="pre">::1</span></tt> (the IPv6 loopback
address):</p>
<ul class="simple">
<li>Now, the first access control rule is enabled as both the <tt class="docutils literal"><span class="pre">path</span></tt> and the
<tt class="docutils literal"><span class="pre">ip</span></tt> match: access is allowed as the user always has the
<tt class="docutils literal"><span class="pre">IS_AUTHENTICATED_ANONYMOUSLY</span></tt> role.</li>
<li>The second access rule is not examined as the first rule matched.</li>
</ul>
</div>
<div class="section" id="securing-by-channel">
<span id="book-security-securing-channel"></span><h3>Securing by Channel<a class="headerlink" href="#securing-by-channel" title="Permalink to this headline">¶</a></h3>
<p>You can also require a user to access a URL via SSL; just use the
<tt class="docutils literal"><span class="pre">requires_channel</span></tt> argument in any <tt class="docutils literal"><span class="pre">access_control</span></tt> entries:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/cart/checkout</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="nv">IS_AUTHENTICATED_ANONYMOUSLY</span><span class="p-Indicator">,</span> <span class="nv">requires_channel</span><span class="p-Indicator">:</span> <span class="nv">https</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;access-control&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">path=</span><span class="s">&quot;^/cart/checkout&quot;</span> <span class="na">role=</span><span class="s">&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot;</span>
        <span class="na">requires_channel=</span><span class="s">&quot;https&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/access-control&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;access_control&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;^/cart/checkout&#39;</span><span class="p">,</span>
        <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;IS_AUTHENTICATED_ANONYMOUSLY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;requires_channel&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">),</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="securing-a-controller">
<span id="book-security-securing-controller"></span><h3>Securing a Controller<a class="headerlink" href="#securing-a-controller" title="Permalink to this headline">¶</a></h3>
<p>Protecting your application based on URL patterns is easy, but may not be
fine-grained enough in certain cases. When necessary, you can easily force
authorization from inside a controller:</p>
<div class="highlight-python"><pre>// ...
use Symfony\Component\Security\Core\Exception\AccessDeniedException;

public function helloAction($name)
{
    if (false === $this-&gt;get('security.context')-&gt;isGranted('ROLE_ADMIN')) {
        throw new AccessDeniedException();
    }

    // ...
}</pre>
</div>
<p id="book-security-securing-controller-annotations">You can also choose to install and use the optional <tt class="docutils literal"><span class="pre">JMSSecurityExtraBundle</span></tt>,
which can secure your controller using annotations:</p>
<div class="highlight-python"><pre>// ...
use JMS\SecurityExtraBundle\Annotation\Secure;

/**
 * @Secure(roles="ROLE_ADMIN")
 */
public function helloAction($name)
{
    // ...
}</pre>
</div>
<p>For more information, see the <a class="reference external" href="http://jmsyst.com/bundles/JMSSecurityExtraBundle/1.2">JMSSecurityExtraBundle</a> documentation.</p>
</div>
<div class="section" id="securing-other-services">
<h3>Securing other Services<a class="headerlink" href="#securing-other-services" title="Permalink to this headline">¶</a></h3>
<p>In fact, anything in Symfony can be protected using a strategy similar to
the one seen in the previous section. For example, suppose you have a service
(i.e. a PHP class) whose job is to send emails from one user to another.
You can restrict use of this class - no matter where it&#8217;s being used from -
to users that have a specific role.</p>
<p>For more information on how you can use the security component to secure
different services and methods in your application, see <a class="reference internal" href="../cookbook/security/securing_services.html"><em>How to secure any Service or Method in your Application</em></a>.</p>
</div>
<div class="section" id="access-control-lists-acls-securing-individual-database-objects">
<h3>Access Control Lists (ACLs): Securing Individual Database Objects<a class="headerlink" href="#access-control-lists-acls-securing-individual-database-objects" title="Permalink to this headline">¶</a></h3>
<p>Imagine you are designing a blog system where your users can comment on your
posts. Now, you want a user to be able to edit his own comments, but not
those of other users. Also, as the admin user, you yourself want to be able
to edit <em>all</em> comments.</p>
<p>The security component comes with an optional access control list (ACL) system
that you can use when you need to control access to individual instances
of an object in your system. <em>Without</em> ACL, you can secure your system so that
only certain users can edit blog comments in general. But <em>with</em> ACL, you
can restrict or allow access on a comment-by-comment basis.</p>
<p>For more information, see the cookbook article: <a class="reference internal" href="../cookbook/security/acl.html"><em>How to use Access Control Lists (ACLs)</em></a>.</p>
</div>
</div>
<div class="section" id="users">
<h2>Users<a class="headerlink" href="#users" title="Permalink to this headline">¶</a></h2>
<p>In the previous sections, you learned how you can protect different resources
by requiring a set of <em>roles</em> for a resource. This section explores
the other side of authorization: users.</p>
<div class="section" id="where-do-users-come-from-user-providers">
<h3>Where do Users come from? (<em>User Providers</em>)<a class="headerlink" href="#where-do-users-come-from-user-providers" title="Permalink to this headline">¶</a></h3>
<p>During authentication, the user submits a set of credentials (usually a username
and password). The job of the authentication system is to match those credentials
against some pool of users. So where does this list of users come from?</p>
<p>In Symfony2, users can come from anywhere - a configuration file, a database
table, a web service, or anything else you can dream up. Anything that provides
one or more users to the authentication system is known as a &#8220;user provider&#8221;.
Symfony2 comes standard with the two most common user providers: one that
loads users from a configuration file and one that loads users from a database
table.</p>
<div class="section" id="specifying-users-in-a-configuration-file">
<h4>Specifying Users in a Configuration File<a class="headerlink" href="#specifying-users-in-a-configuration-file" title="Permalink to this headline">¶</a></h4>
<p>The easiest way to specify your users is directly in a configuration file.
In fact, you&#8217;ve seen this already in the example in this chapter.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">default_provider</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">memory</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">ryan</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">ryanpass</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_USER&#39;</span> <span class="p-Indicator">}</span>
                    <span class="l-Scalar-Plain">admin</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">kitten</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_ADMIN&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;default_provider&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;memory&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;ryan&quot;</span> <span class="na">password=</span><span class="s">&quot;ryanpass&quot;</span> <span class="na">roles=</span><span class="s">&quot;ROLE_USER&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;admin&quot;</span> <span class="na">password=</span><span class="s">&quot;kitten&quot;</span> <span class="na">roles=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/memory&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;default_provider&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;users&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">&#39;ryan&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ryanpass&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="s1">&#39;admin&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;kitten&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>This user provider is called the &#8220;in-memory&#8221; user provider, since the users
aren&#8217;t stored anywhere in a database. The actual user object is provided
by Symfony (<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/User/User.html" title="Symfony\Component\Security\Core\User\User"><span class="pre">User</span></a></tt>).</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Any user provider can load users directly from configuration by specifying
the <tt class="docutils literal"><span class="pre">users</span></tt> configuration parameter and listing the users beneath it.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p>If your username is completely numeric (e.g. <tt class="docutils literal"><span class="pre">77</span></tt>) or contains a dash
(e.g. <tt class="docutils literal"><span class="pre">user-name</span></tt>), you should use that alternative syntax when specifying
users in YAML:</p>
<div class="last highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">77</span><span class="p-Indicator">,</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">pass</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_USER&#39;</span> <span class="p-Indicator">}</span>
    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">user-name</span><span class="p-Indicator">,</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">pass</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_USER&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</div>
<p>For smaller sites, this method is quick and easy to setup. For more complex
systems, you&#8217;ll want to load your users from the database.</p>
</div>
<div class="section" id="loading-users-from-the-database">
<span id="book-security-user-entity"></span><h4>Loading Users from the Database<a class="headerlink" href="#loading-users-from-the-database" title="Permalink to this headline">¶</a></h4>
<p>If you&#8217;d like to load your users via the Doctrine ORM, you can easily do
this by creating a <tt class="docutils literal"><span class="pre">User</span></tt> class and configuring the <tt class="docutils literal"><span class="pre">entity</span></tt> provider.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A high-quality open source bundle is available that allows your users
to be stored via the Doctrine ORM or ODM. Read more about the <a class="reference external" href="https://github.com/FriendsOfSymfony/FOSUserBundle">FOSUserBundle</a>
on GitHub.</p>
</div>
<p>With this approach, you&#8217;ll first create your own <tt class="docutils literal"><span class="pre">User</span></tt> class, which will
be stored in the database.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/UserBundle/Entity/User.php</span>
<span class="k">namespace</span> <span class="nx">Acme\UserBundle\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Security\Core\User\UserInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Doctrine\ORM\Mapping</span> <span class="k">as</span> <span class="nx">ORM</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * @ORM\Entity</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">implements</span> <span class="nx">UserInterface</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @ORM\Column(type=&quot;string&quot;, length=255)</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$username</span><span class="p">;</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As far as the security system is concerned, the only requirement for your
custom user class is that it implements the <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/User/UserInterface.html" title="Symfony\Component\Security\Core\User\UserInterface"><span class="pre">UserInterface</span></a></tt>
interface. This means that your concept of a &#8220;user&#8221; can be anything, as long
as it implements this interface.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The user object will be serialized and saved in the session during requests,
therefore it is recommended that you <a class="reference external" href="http://php.net/manual/en/class.serializable.php">implement the Serializable interface</a>
in your user object. This is especially important if your <tt class="docutils literal"><span class="pre">User</span></tt> class
has a parent class with private properties.</p>
</div>
<p>Next, configure an <tt class="docutils literal"><span class="pre">entity</span></tt> user provider, and point it to your <tt class="docutils literal"><span class="pre">User</span></tt>
class:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">main</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">entity</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">class</span><span class="p-Indicator">:</span> <span class="nv">Acme\UserBundle\Entity\User</span><span class="p-Indicator">,</span> <span class="nv">property</span><span class="p-Indicator">:</span> <span class="nv">username</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;entity</span> <span class="na">class=</span><span class="s">&quot;Acme\UserBundle\Entity\User&quot;</span> <span class="na">property=</span><span class="s">&quot;username&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;main&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;entity&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Acme\UserBundle\Entity\User&#39;</span><span class="p">,</span>
                <span class="s1">&#39;property&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>With the introduction of this new provider, the authentication system will
attempt to load a <tt class="docutils literal"><span class="pre">User</span></tt> object from the database by using the <tt class="docutils literal"><span class="pre">username</span></tt>
field of that class.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example is just meant to show you the basic idea behind the <tt class="docutils literal"><span class="pre">entity</span></tt>
provider. For a full working example, see <a class="reference internal" href="../cookbook/security/entity_provider.html"><em>How to load Security Users from the Database (the Entity Provider)</em></a>.</p>
</div>
<p>For more information on creating your own custom provider (e.g. if you needed
to load users via a web service), see <a class="reference internal" href="../cookbook/security/custom_provider.html"><em>How to create a custom User Provider</em></a>.</p>
</div>
</div>
<div class="section" id="encoding-the-user-s-password">
<span id="book-security-encoding-user-password"></span><h3>Encoding the User&#8217;s Password<a class="headerlink" href="#encoding-the-user-s-password" title="Permalink to this headline">¶</a></h3>
<p>So far, for simplicity, all the examples have stored the users&#8217; passwords
in plain text (whether those users are stored in a configuration file or in
a database somewhere). Of course, in a real application, you&#8217;ll want to encode
your users&#8217; passwords for security reasons. This is easily accomplished by
mapping your User class to one of several built-in &#8220;encoders&#8221;. For example,
to store your users in memory, but obscure their passwords via <tt class="docutils literal"><span class="pre">sha1</span></tt>,
do the following:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">in_memory</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">memory</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">ryan</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">bb87a29949f3a1ee0559f8a57357487151281386</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_USER&#39;</span> <span class="p-Indicator">}</span>
                    <span class="l-Scalar-Plain">admin</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">74913f5cd5f61ec0bcfdb775414c2fb3d161b620</span><span class="p-Indicator">,</span> <span class="nv">roles</span><span class="p-Indicator">:</span> <span class="s">&#39;ROLE_ADMIN&#39;</span> <span class="p-Indicator">}</span>

    <span class="l-Scalar-Plain">encoders</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">Symfony\Component\Security\Core\User\User</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">algorithm</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha1</span>
            <span class="l-Scalar-Plain">iterations</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
            <span class="l-Scalar-Plain">encode_as_base64</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;in_memory&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;memory&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;ryan&quot;</span>
                <span class="na">password=</span><span class="s">&quot;bb87a29949f3a1ee0559f8a57357487151281386&quot;</span>
                <span class="na">roles=</span><span class="s">&quot;ROLE_USER&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;admin&quot;</span>
                <span class="na">password=</span><span class="s">&quot;74913f5cd5f61ec0bcfdb775414c2fb3d161b620&quot;</span>
                <span class="na">roles=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/memory&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>

    <span class="nt">&lt;encoder</span> <span class="na">class=</span><span class="s">&quot;Symfony\Component\Security\Core\User\User&quot;</span>
        <span class="na">algorithm=</span><span class="s">&quot;sha1&quot;</span>
        <span class="na">iterations=</span><span class="s">&quot;1&quot;</span>
        <span class="na">encode_as_base64=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;in_memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;users&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">&#39;ryan&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bb87a29949f3a1ee0559f8a57357487151281386&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="s1">&#39;admin&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;74913f5cd5f61ec0bcfdb775414c2fb3d161b620&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;roles&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="s1">&#39;encoders&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Symfony\Component\Security\Core\User\User&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;algorithm&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;iterations&#39;</span>        <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;encode_as_base64&#39;</span>  <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>By setting the <tt class="docutils literal"><span class="pre">iterations</span></tt> to <tt class="docutils literal"><span class="pre">1</span></tt> and the <tt class="docutils literal"><span class="pre">encode_as_base64</span></tt> to false,
the password is simply run through the <tt class="docutils literal"><span class="pre">sha1</span></tt> algorithm one time and without
any extra encoding. You can now calculate the hashed password either programmatically
(e.g. <tt class="docutils literal"><span class="pre">hash('sha1',</span> <span class="pre">'ryanpass')</span></tt>) or via some online tool like <a class="reference external" href="http://www.functions-online.com/sha1.html">functions-online.com</a></p>
<p>If you&#8217;re creating your users dynamically (and storing them in a database),
you can use even tougher hashing algorithms and then rely on an actual password
encoder object to help you encode passwords. For example, suppose your User
object is <tt class="docutils literal"><span class="pre">Acme\UserBundle\Entity\User</span></tt> (like in the above example). First,
configure the encoder for that user:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>

    <span class="l-Scalar-Plain">encoders</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">Acme\UserBundle\Entity\User</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>

    <span class="nt">&lt;encoder</span> <span class="na">class=</span><span class="s">&quot;Acme\UserBundle\Entity\User&quot;</span> <span class="na">algorithm=</span><span class="s">&quot;sha512&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;encoders&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Acme\UserBundle\Entity\User&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha512&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>In this case, you&#8217;re using the stronger <tt class="docutils literal"><span class="pre">sha512</span></tt> algorithm. Also, since
you&#8217;ve simply specified the algorithm (<tt class="docutils literal"><span class="pre">sha512</span></tt>) as a string, the system
will default to hashing your password 5000 times in a row and then encoding
it as base64. In other words, the password has been greatly obfuscated so
that the hashed password can&#8217;t be decoded (i.e. you can&#8217;t determine the password
from the hashed password).</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span>As of Symfony 2.2 you can also use the <a class="reference internal" href="../reference/configuration/security.html#reference-security-pbkdf2"><em>PBKDF2</em></a>
and <a class="reference internal" href="../reference/configuration/security.html#reference-security-bcrypt"><em>BCrypt</em></a> password encoders.</p>
<div class="section" id="determining-the-hashed-password">
<h4>Determining the Hashed Password<a class="headerlink" href="#determining-the-hashed-password" title="Permalink to this headline">¶</a></h4>
<p>If you have some sort of registration form for users, you&#8217;ll need to be able
to determine the hashed password so that you can set it on your user. No
matter what algorithm you configure for your user object, the hashed password
can always be determined in the following way from a controller:</p>
<div class="highlight-python"><pre>$factory = $this-&gt;get('security.encoder_factory');
$user = new Acme\UserBundle\Entity\User();

$encoder = $factory-&gt;getEncoder($user);
$password = $encoder-&gt;encodePassword('ryanpass', $user-&gt;getSalt());
$user-&gt;setPassword($password);</pre>
</div>
</div>
</div>
<div class="section" id="retrieving-the-user-object">
<h3>Retrieving the User Object<a class="headerlink" href="#retrieving-the-user-object" title="Permalink to this headline">¶</a></h3>
<p>After authentication, the <tt class="docutils literal"><span class="pre">User</span></tt> object of the current user can be accessed
via the <tt class="docutils literal"><span class="pre">security.context</span></tt> service. From inside a controller, this will
look like:</p>
<div class="highlight-python"><pre>public function indexAction()
{
    $user = $this-&gt;get('security.context')-&gt;getToken()-&gt;getUser();
}</pre>
</div>
<p>In a controller this can be shortcut to:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getUser</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Anonymous users are technically authenticated, meaning that the <tt class="docutils literal"><span class="pre">isAuthenticated()</span></tt>
method of an anonymous user object will return true. To check if your
user is actually authenticated, check for the <tt class="docutils literal"><span class="pre">IS_AUTHENTICATED_FULLY</span></tt>
role.</p>
</div>
<p>In a Twig Template this object can be accessed via the <tt class="docutils literal"><span class="pre">app.user</span></tt> key,
which calls the <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/FrameworkBundle/Templating/GlobalVariables.html#method_getUser" title="Symfony\Bundle\FrameworkBundle\Templating\GlobalVariables::getUser()"><span class="pre">GlobalVariables::getUser()</span></a></tt>
method:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>Username: <span class="cp">{{</span> <span class="nv">app.user.username</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>Username: <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">getUser</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getUsername</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="using-multiple-user-providers">
<h3>Using Multiple User Providers<a class="headerlink" href="#using-multiple-user-providers" title="Permalink to this headline">¶</a></h3>
<p>Each authentication mechanism (e.g. HTTP Authentication, form login, etc)
uses exactly one user provider, and will use the first declared user provider
by default. But what if you want to specify a few users via configuration
and the rest of your users in the database? This is possible by creating
a new provider that chains the two together:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">chain_provider</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">chain</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">in_memory</span><span class="p-Indicator">,</span> <span class="nv">user_db</span><span class="p-Indicator">]</span>
        <span class="l-Scalar-Plain">in_memory</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">memory</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">foo</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">test</span> <span class="p-Indicator">}</span>
        <span class="l-Scalar-Plain">user_db</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">entity</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">class</span><span class="p-Indicator">:</span> <span class="nv">Acme\UserBundle\Entity\User</span><span class="p-Indicator">,</span> <span class="nv">property</span><span class="p-Indicator">:</span> <span class="nv">username</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;chain_provider&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;chain&gt;</span>
            <span class="nt">&lt;provider&gt;</span>in_memory<span class="nt">&lt;/provider&gt;</span>
            <span class="nt">&lt;provider&gt;</span>user_db<span class="nt">&lt;/provider&gt;</span>
        <span class="nt">&lt;/chain&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;in_memory&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;memory&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;foo&quot;</span> <span class="na">password=</span><span class="s">&quot;test&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/memory&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">&quot;user_db&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;entity</span> <span class="na">class=</span><span class="s">&quot;Acme\UserBundle\Entity\User&quot;</span> <span class="na">property=</span><span class="s">&quot;username&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;chain_provider&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;chain&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;in_memory&#39;</span><span class="p">,</span> <span class="s1">&#39;user_db&#39;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="s1">&#39;in_memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
               <span class="s1">&#39;users&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                   <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span><span class="p">),</span>
               <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="s1">&#39;user_db&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;entity&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Acme\UserBundle\Entity\User&#39;</span><span class="p">,</span>
                <span class="s1">&#39;property&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Now, all authentication mechanisms will use the <tt class="docutils literal"><span class="pre">chain_provider</span></tt>, since
it&#8217;s the first specified. The <tt class="docutils literal"><span class="pre">chain_provider</span></tt> will, in turn, try to load
the user from both the <tt class="docutils literal"><span class="pre">in_memory</span></tt> and <tt class="docutils literal"><span class="pre">user_db</span></tt> providers.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>If you have no reasons to separate your <tt class="docutils literal"><span class="pre">in_memory</span></tt> users from your
<tt class="docutils literal"><span class="pre">user_db</span></tt> users, you can accomplish this even more easily by combining
the two sources into a single provider:</p>
<div class="last configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">main_provider</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">memory</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">users</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">foo</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">password</span><span class="p-Indicator">:</span> <span class="nv">test</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">entity</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Acme\UserBundle\Entity\User,</span>
                <span class="l-Scalar-Plain">property</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">username</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">=&quot;main_provider&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;memory&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">name=</span><span class="s">&quot;foo&quot;</span> <span class="na">password=</span><span class="s">&quot;test&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/memory&gt;</span>

        <span class="nt">&lt;entity</span> <span class="na">class=</span><span class="s">&quot;Acme\UserBundle\Entity\User&quot;</span>
            <span class="na">property=</span><span class="s">&quot;username&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;providers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;main_provider&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;memory&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;users&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s1">&#39;entity&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Acme\UserBundle\Entity\User&#39;</span><span class="p">,</span>
            <span class="s1">&#39;property&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;username&#39;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<p>You can also configure the firewall or individual authentication mechanisms
to use a specific provider. Again, unless a provider is specified explicitly,
the first provider is always used:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">secured_area</span><span class="p-Indicator">:</span>
            <span class="c1"># ...</span>
            <span class="l-Scalar-Plain">provider</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">user_db</span>
            <span class="l-Scalar-Plain">http_basic</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">realm</span><span class="p-Indicator">:</span> <span class="s">&quot;Secured</span><span class="nv"> </span><span class="s">Demo</span><span class="nv"> </span><span class="s">Area&quot;</span>
                <span class="l-Scalar-Plain">provider</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">in_memory</span>
            <span class="l-Scalar-Plain">form_login</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;secured_area&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/&quot;</span> <span class="na">provider=</span><span class="s">&quot;user_db&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
        <span class="nt">&lt;http-basic</span> <span class="na">realm=</span><span class="s">&quot;Secured Demo Area&quot;</span> <span class="na">provider=</span><span class="s">&quot;in_memory&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form-login</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/firewall&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;secured_area&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="c1">// ...</span>
            <span class="s1">&#39;provider&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;user_db&#39;</span><span class="p">,</span>
            <span class="s1">&#39;http_basic&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="c1">// ...</span>
                <span class="s1">&#39;provider&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;in_memory&#39;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s1">&#39;form_login&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>In this example, if a user tries to login via HTTP authentication, the authentication
system will use the <tt class="docutils literal"><span class="pre">in_memory</span></tt> user provider. But if the user tries to
login via the form login, the <tt class="docutils literal"><span class="pre">user_db</span></tt> provider will be used (since it&#8217;s
the default for the firewall as a whole).</p>
<p>For more information about user provider and firewall configuration, see
the <a class="reference internal" href="../reference/configuration/security.html"><em>Security Configuration Reference</em></a>.</p>
</div>
</div>
<div class="section" id="roles">
<h2>Roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h2>
<p>The idea of a &#8220;role&#8221; is key to the authorization process. Each user is assigned
a set of roles and then each resource requires one or more roles. If the user
has the required roles, access is granted. Otherwise access is denied.</p>
<p>Roles are pretty simple, and are basically strings that you can invent and
use as needed (though roles are objects internally). For example, if you
need to start limiting access to the blog admin section of your website,
you could protect that section using a <tt class="docutils literal"><span class="pre">ROLE_BLOG_ADMIN</span></tt> role. This role
doesn&#8217;t need to be defined anywhere - you can just start using it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All roles <strong>must</strong> begin with the <tt class="docutils literal"><span class="pre">ROLE_</span></tt> prefix to be managed by
Symfony2. If you define your own roles with a dedicated <tt class="docutils literal"><span class="pre">Role</span></tt> class
(more advanced), don&#8217;t use the <tt class="docutils literal"><span class="pre">ROLE_</span></tt> prefix.</p>
</div>
<div class="section" id="hierarchical-roles">
<h3>Hierarchical Roles<a class="headerlink" href="#hierarchical-roles" title="Permalink to this headline">¶</a></h3>
<p>Instead of associating many roles to users, you can define role inheritance
rules by creating a role hierarchy:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">role_hierarchy</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">ROLE_ADMIN</span><span class="p-Indicator">:</span>       <span class="l-Scalar-Plain">ROLE_USER</span>
        <span class="l-Scalar-Plain">ROLE_SUPER_ADMIN</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">ROLE_ADMIN</span><span class="p-Indicator">,</span> <span class="nv">ROLE_ALLOWED_TO_SWITCH</span><span class="p-Indicator">]</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;role</span> <span class="na">id=</span><span class="s">&quot;ROLE_ADMIN&quot;</span><span class="nt">&gt;</span>ROLE_USER<span class="nt">&lt;/role&gt;</span>
    <span class="nt">&lt;role</span> <span class="na">id=</span><span class="s">&quot;ROLE_SUPER_ADMIN&quot;</span><span class="nt">&gt;</span>ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH<span class="nt">&lt;/role&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;role_hierarchy&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;ROLE_ADMIN&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ROLE_SUPER_ADMIN&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ROLE_ALLOWED_TO_SWITCH&#39;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>In the above configuration, users with <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt> role will also have the
<tt class="docutils literal"><span class="pre">ROLE_USER</span></tt> role. The <tt class="docutils literal"><span class="pre">ROLE_SUPER_ADMIN</span></tt> role has <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt>, <tt class="docutils literal"><span class="pre">ROLE_ALLOWED_TO_SWITCH</span></tt>
and <tt class="docutils literal"><span class="pre">ROLE_USER</span></tt> (inherited from <tt class="docutils literal"><span class="pre">ROLE_ADMIN</span></tt>).</p>
</div>
</div>
<div class="section" id="logging-out">
<h2>Logging Out<a class="headerlink" href="#logging-out" title="Permalink to this headline">¶</a></h2>
<p>Usually, you&#8217;ll also want your users to be able to log out. Fortunately,
the firewall can handle this automatically for you when you activate the
<tt class="docutils literal"><span class="pre">logout</span></tt> config parameter:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">secured_area</span><span class="p-Indicator">:</span>
            <span class="c1"># ...</span>
            <span class="l-Scalar-Plain">logout</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/logout</span>
                <span class="l-Scalar-Plain">target</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;firewall</span> <span class="na">name=</span><span class="s">&quot;secured_area&quot;</span> <span class="na">pattern=</span><span class="s">&quot;^/&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
        <span class="nt">&lt;logout</span> <span class="na">path=</span><span class="s">&quot;/logout&quot;</span> <span class="na">target=</span><span class="s">&quot;/&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/firewall&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;secured_area&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="c1">// ...</span>
            <span class="s1">&#39;logout&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/&#39;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Once this is configured under your firewall, sending a user to <tt class="docutils literal"><span class="pre">/logout</span></tt>
(or whatever you configure the <tt class="docutils literal"><span class="pre">path</span></tt> to be), will un-authenticate the
current user. The user will then be sent to the homepage (the value defined
by the <tt class="docutils literal"><span class="pre">target</span></tt> parameter). Both the <tt class="docutils literal"><span class="pre">path</span></tt> and <tt class="docutils literal"><span class="pre">target</span></tt> config parameters
default to what&#8217;s specified here. In other words, unless you need to customize
them, you can omit them entirely and shorten your configuration:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">logout</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;logout</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="s1">&#39;logout&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Note that you will <em>not</em> need to implement a controller for the <tt class="docutils literal"><span class="pre">/logout</span></tt>
URL as the firewall takes care of everything. You <em>do</em>, however, need to create
a route so that you can use it to generate the URL:</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">You <em>must</em> have a route that corresponds to your logout path. Without
this route, logging out will not work.</p>
</div>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/routing.yml</span>
<span class="l-Scalar-Plain">logout</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/logout</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing</span>
<span class="s">        http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;logout&quot;</span> <span class="na">path=</span><span class="s">&quot;/logout&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/routing.php</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Routing\RouteCollection</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Routing\Route</span><span class="p">;</span>

<span class="nv">$collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RouteCollection</span><span class="p">();</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">()));</span>

<span class="k">return</span> <span class="nv">$collection</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Once the user has been logged out, he will be redirected to whatever path
is defined by the <tt class="docutils literal"><span class="pre">target</span></tt> parameter above (e.g. the <tt class="docutils literal"><span class="pre">homepage</span></tt>). For
more information on configuring the logout, see the
<a class="reference internal" href="../reference/configuration/security.html"><em>Security Configuration Reference</em></a>.</p>
</div>
<div class="section" id="access-control-in-templates">
<span id="book-security-template"></span><h2>Access Control in Templates<a class="headerlink" href="#access-control-in-templates" title="Permalink to this headline">¶</a></h2>
<p>If you want to check if the current user has a role inside a template, use
the built-in helper function:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="nv">is_granted</span><span class="o">(</span><span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="o">)</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;...&quot;</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;security&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;...&quot;</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you use this function and are <em>not</em> at a URL where there is a firewall
active, an exception will be thrown. Again, it&#8217;s almost always a good
idea to have a main firewall that covers all URLs (as has been shown
in this chapter).</p>
</div>
</div>
<div class="section" id="access-control-in-controllers">
<h2>Access Control in Controllers<a class="headerlink" href="#access-control-in-controllers" title="Permalink to this headline">¶</a></h2>
<p>If you want to check if the current user has a role in your controller, use
the <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/SecurityContext.html#method_isGranted" title="Symfony\Component\Security\Core\SecurityContext::isGranted()"><span class="pre">isGranted()</span></a></tt>
method of the security context:</p>
<div class="highlight-python"><pre>public function indexAction()
{
    // show different content to admin users
    if ($this-&gt;get('security.context')-&gt;isGranted('ROLE_ADMIN')) {
        // ... load admin content here
    }

    // ... load other regular content here
}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A firewall must be active or an exception will be thrown when the <tt class="docutils literal"><span class="pre">isGranted</span></tt>
method is called. See the note above about templates for more details.</p>
</div>
</div>
<div class="section" id="impersonating-a-user">
<h2>Impersonating a User<a class="headerlink" href="#impersonating-a-user" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, it&#8217;s useful to be able to switch from one user to another without
having to logout and login again (for instance when you are debugging or trying
to understand a bug a user sees that you can&#8217;t reproduce). This can be easily
done by activating the <tt class="docutils literal"><span class="pre">switch_user</span></tt> firewall listener:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">main</span><span class="p-Indicator">:</span>
            <span class="c1"># ...</span>
            <span class="l-Scalar-Plain">switch_user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;firewall&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
        <span class="nt">&lt;switch-user</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/firewall&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;main&#39;</span><span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="c1">// ...</span>
            <span class="s1">&#39;switch_user&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>To switch to another user, just add a query string with the <tt class="docutils literal"><span class="pre">_switch_user</span></tt>
parameter and the username as the value to the current URL:</p>
<div class="highlight-text"><div class="highlight"><pre>http://example.com/somewhere?_switch_user=thomas
</pre></div>
</div>
<p>To switch back to the original user, use the special <tt class="docutils literal"><span class="pre">_exit</span></tt> username:</p>
<div class="highlight-text"><div class="highlight"><pre>http://example.com/somewhere?_switch_user=_exit
</pre></div>
</div>
<p>During impersonation, the user is provided with a special role called
<tt class="docutils literal"><span class="pre">ROLE_PREVIOUS_ADMIN</span></tt>. In a template, for instance, this role can be used
to show a link to exit impersonation:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><pre>{% if is_granted('ROLE_PREVIOUS_ADMIN') %}
    &lt;a href="{{ path('homepage', {_switch_user: '_exit'}) }}"&gt;Exit impersonation&lt;/a&gt;
{% endif %}</pre>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;security&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="s1">&#39;ROLE_PREVIOUS_ADMIN&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;a</span>
        <span class="na">href=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;homepage&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;_switch_user&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;_exit&#39;</span><span class="p">,</span>
        <span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span>
    <span class="nt">&gt;</span>
        Exit impersonation
    <span class="nt">&lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Of course, this feature needs to be made available to a small group of users.
By default, access is restricted to users having the <tt class="docutils literal"><span class="pre">ROLE_ALLOWED_TO_SWITCH</span></tt>
role. The name of this role can be modified via the <tt class="docutils literal"><span class="pre">role</span></tt> setting. For
extra security, you can also change the query parameter name via the <tt class="docutils literal"><span class="pre">parameter</span></tt>
setting:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">main</span><span class="p-Indicator">:</span>
            <span class="c1"># ...</span>
            <span class="l-Scalar-Plain">switch_user</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">role</span><span class="p-Indicator">:</span> <span class="nv">ROLE_ADMIN</span><span class="p-Indicator">,</span> <span class="nv">parameter</span><span class="p-Indicator">:</span> <span class="nv">_want_to_be_this_user</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;firewall&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
        <span class="nt">&lt;switch-user</span> <span class="na">role=</span><span class="s">&quot;ROLE_ADMIN&quot;</span> <span class="na">parameter=</span><span class="s">&quot;_want_to_be_this_user&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/firewall&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;main&#39;</span><span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="c1">// ...</span>
            <span class="s1">&#39;switch_user&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span>
                <span class="s1">&#39;parameter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;_want_to_be_this_user&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="stateless-authentication">
<h2>Stateless Authentication<a class="headerlink" href="#stateless-authentication" title="Permalink to this headline">¶</a></h2>
<p>By default, Symfony2 relies on a cookie (the Session) to persist the security
context of the user. But if you use certificates or HTTP authentication for
instance, persistence is not needed as credentials are available for each
request. In that case, and if you don&#8217;t need to store anything else between
requests, you can activate the stateless authentication (which means that no
cookie will be ever created by Symfony2):</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/security.yml</span>
<span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">firewalls</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">main</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">http_basic</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
            <span class="l-Scalar-Plain">stateless</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/security.xml --&gt;</span>
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;firewall</span> <span class="na">stateless=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;http-basic</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/firewall&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/security.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;firewalls&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;main&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;http_basic&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span> <span class="s1">&#39;stateless&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you use a form login, Symfony2 will create a cookie even if you set
<tt class="docutils literal"><span class="pre">stateless</span></tt> to <tt class="docutils literal"><span class="pre">true</span></tt>.</p>
</div>
</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span>The <tt class="docutils literal"><span class="pre">StringUtils</span></tt> and <tt class="docutils literal"><span class="pre">SecureRandom</span></tt> classes were added in Symfony 2.2</p>
<p>The Symfony Security Component comes with a collection of nice utilities related
to security. These utilities are used by Symfony, but you should also use
them if you want to solve the problem they address.</p>
<div class="section" id="comparing-strings">
<h3>Comparing Strings<a class="headerlink" href="#comparing-strings" title="Permalink to this headline">¶</a></h3>
<p>The time it takes to compare two strings depends on their differences. This
can be used by an attacker when the two strings represent a password for
instance; it is known as a <a class="reference external" href="http://en.wikipedia.org/wiki/Timing_attack">Timing attack</a>.</p>
<p>Internally, when comparing two passwords, Symfony uses a constant-time
algorithm; you can use the same strategy in your own code thanks to the
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Util/StringUtils.html" title="Symfony\Component\Security\Core\Util\StringUtils"><span class="pre">StringUtils</span></a></tt> class:</p>
<div class="highlight-python"><pre>use Symfony\Component\Security\Core\Util\StringUtils;

// is password1 equals to password2?
$bool = StringUtils::equals($password1, $password2);</pre>
</div>
</div>
<div class="section" id="generating-a-secure-random-number">
<h3>Generating a secure Random Number<a class="headerlink" href="#generating-a-secure-random-number" title="Permalink to this headline">¶</a></h3>
<p>Whenever you need to generate a secure random number, you are highly
encouraged to use the Symfony
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Util/SecureRandom.html" title="Symfony\Component\Security\Core\Util\SecureRandom"><span class="pre">SecureRandom</span></a></tt> class:</p>
<div class="highlight-python"><pre>use Symfony\Component\Security\Core\Util\SecureRandom;

$generator = new SecureRandom();
$random = $generator-&gt;nextBytes(10);</pre>
</div>
<p>The
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Util/SecureRandom.html#method_nextBytes" title="Symfony\Component\Security\Core\Util\SecureRandom::nextBytes()"><span class="pre">nextBytes()</span></a></tt>
methods returns a random string composed of the number of characters passed as
an argument (10 in the above example).</p>
<p>The SecureRandom class works better when OpenSSL is installed but when it&#8217;s
not available, it falls back to an internal algorithm, which needs a seed file
to work correctly. Just pass a file name to enable it:</p>
<div class="highlight-python"><pre>$generator = new SecureRandom('/some/path/to/store/the/seed.txt');
$random = $generator-&gt;nextBytes(10);</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also access a secure random instance directly from the Symfony
dependency injection container; its name is <tt class="docutils literal"><span class="pre">security.secure_random</span></tt>.</p>
</div>
</div>
</div>
<div class="section" id="final-words">
<h2>Final Words<a class="headerlink" href="#final-words" title="Permalink to this headline">¶</a></h2>
<p>Security can be a deep and complex issue to solve correctly in your application.
Fortunately, Symfony&#8217;s security component follows a well-proven security
model based around <em>authentication</em> and <em>authorization</em>. Authentication,
which always happens first, is handled by a firewall whose job is to determine
the identity of the user through several different methods (e.g. HTTP authentication,
login form, etc). In the cookbook, you&#8217;ll find examples of other methods
for handling authentication, including how to implement a &#8220;remember me&#8221; cookie
functionality.</p>
<p>Once a user is authenticated, the authorization layer can determine whether
or not the user should have access to a specific resource. Most commonly,
<em>roles</em> are applied to URLs, classes or methods and if the current user
doesn&#8217;t have that role, access is denied. The authorization layer, however,
is much deeper, and follows a system of &#8220;voting&#8221; so that multiple parties
can determine if the current user should have access to a given resource.
Find out more about this and other topics in the cookbook.</p>
</div>
<div class="section" id="learn-more-from-the-cookbook">
<h2>Learn more from the Cookbook<a class="headerlink" href="#learn-more-from-the-cookbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../cookbook/security/force_https.html"><em>Forcing HTTP/HTTPS</em></a></li>
<li><a class="reference internal" href="../cookbook/security/voters.html"><em>Blacklist users by IP address with a custom voter</em></a></li>
<li><a class="reference internal" href="../cookbook/security/acl.html"><em>Access Control Lists (ACLs)</em></a></li>
<li><a class="reference internal" href="../cookbook/security/remember_me.html"><em>How to add &#8220;Remember Me&#8221; Login Functionality</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Security</a><ul>
<li><a class="reference internal" href="#basic-example-http-authentication">Basic Example: HTTP Authentication</a></li>
<li><a class="reference internal" href="#how-security-works-authentication-and-authorization">How Security Works: Authentication and Authorization</a><ul>
<li><a class="reference internal" href="#firewalls-authentication">Firewalls (Authentication)</a></li>
<li><a class="reference internal" href="#access-controls-authorization">Access Controls (Authorization)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-a-traditional-login-form">Using a Traditional Login Form</a></li>
<li><a class="reference internal" href="#authorization">Authorization</a><ul>
<li><a class="reference internal" href="#securing-specific-url-patterns">Securing Specific URL Patterns</a></li>
<li><a class="reference internal" href="#understanding-how-access-control-works">Understanding how <tt class="docutils literal"><span class="pre">access_control</span></tt> works</a></li>
<li><a class="reference internal" href="#securing-by-ip">Securing by IP</a></li>
<li><a class="reference internal" href="#securing-by-channel">Securing by Channel</a></li>
<li><a class="reference internal" href="#securing-a-controller">Securing a Controller</a></li>
<li><a class="reference internal" href="#securing-other-services">Securing other Services</a></li>
<li><a class="reference internal" href="#access-control-lists-acls-securing-individual-database-objects">Access Control Lists (ACLs): Securing Individual Database Objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#users">Users</a><ul>
<li><a class="reference internal" href="#where-do-users-come-from-user-providers">Where do Users come from? (<em>User Providers</em>)</a><ul>
<li><a class="reference internal" href="#specifying-users-in-a-configuration-file">Specifying Users in a Configuration File</a></li>
<li><a class="reference internal" href="#loading-users-from-the-database">Loading Users from the Database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#encoding-the-user-s-password">Encoding the User&#8217;s Password</a><ul>
<li><a class="reference internal" href="#determining-the-hashed-password">Determining the Hashed Password</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieving-the-user-object">Retrieving the User Object</a></li>
<li><a class="reference internal" href="#using-multiple-user-providers">Using Multiple User Providers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#roles">Roles</a><ul>
<li><a class="reference internal" href="#hierarchical-roles">Hierarchical Roles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging-out">Logging Out</a></li>
<li><a class="reference internal" href="#access-control-in-templates">Access Control in Templates</a></li>
<li><a class="reference internal" href="#access-control-in-controllers">Access Control in Controllers</a></li>
<li><a class="reference internal" href="#impersonating-a-user">Impersonating a User</a></li>
<li><a class="reference internal" href="#stateless-authentication">Stateless Authentication</a></li>
<li><a class="reference internal" href="#utilities">Utilities</a><ul>
<li><a class="reference internal" href="#comparing-strings">Comparing Strings</a></li>
<li><a class="reference internal" href="#generating-a-secure-random-number">Generating a secure Random Number</a></li>
</ul>
</li>
<li><a class="reference internal" href="#final-words">Final Words</a></li>
<li><a class="reference internal" href="#learn-more-from-the-cookbook">Learn more from the Cookbook</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="forms.html"
                        title="previous chapter">Forms</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="http_cache.html"
                        title="next chapter">HTTP Cache</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/book/security.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="http_cache.html" title="HTTP Cache"
             >next</a> |</li>
        <li class="right" >
          <a href="forms.html" title="Forms"
             >previous</a> |</li>
        <li><a href="../index.html">Symfony Docs 2.3 documentation</a> &raquo;</li>
          <li><a href="index.html" >The Book</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Symfony Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>